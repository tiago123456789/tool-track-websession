var rrweb=function(e){"use strict";var j;function P(e){return e.nodeType===e.ELEMENT_NODE}function W(e){var t=e?.host;return Boolean(t?.shadowRoot===e)}function U(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function G(e){try{var t=e.rules||e.cssRules;return t?r=(r=Array.from(t).map(d).join("")).includes(" background-clip: text;")&&!r.includes(" -webkit-background-clip: text;")?r.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;"):r:null}catch{return null}var r}function d(e){var t=e.cssText;if("styleSheet"in e)try{t=G(e.styleSheet)||t}catch{}return t}(r=j=j||{})[r.Document=0]="Document",r[r.DocumentType=1]="DocumentType",r[r.Element=2]="Element",r[r.Text=3]="Text",r[r.CDATA=4]="CDATA",r[r.Comment=5]="Comment";t.prototype.getId=function(e){return e?(null==(e=this.getMeta(e))?void 0:e.id)??-1:-1},t.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},t.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},t.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},t.prototype.removeNodeFromMap=function(e){var t=this,r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach(function(e){return t.removeNodeFromMap(e)})},t.prototype.has=function(e){return this.idNodeMap.has(e)},t.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},t.prototype.add=function(e,t){var r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)},t.prototype.replace=function(e,t){var r=this.getNode(e);r&&(r=this.nodeMetaMap.get(r))&&this.nodeMetaMap.set(t,r),this.idNodeMap.set(e,t)},t.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap};var re=t;function t(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}function f(){return new re}function z(e){var t=e.maskInputOptions,r=e.tagName,n=e.type,o=e.value,e=e.maskInputFn,o=o||"";return o=t[r.toLowerCase()]||t[n]?e?e(o):"*".repeat(o.length):o}var ne="__rrweb_original__";var V=1,oe=new RegExp("[^a-z0-9-_:]"),ie=-2;function y(){return V++}var B,se,g=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,v=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,S=/^(data:)([^,]*),(.*)/i;function ae(e,d){return(e||"").replace(g,function(e,t,r,n,o,i){r=r||o||i,o=t||n||"";if(!r)return e;if(!v.test(r)||S.test(r))return"url(".concat(o).concat(r).concat(o,")");if("/"===r[0])return"url(".concat(o).concat((-1<(i=d).indexOf("//")?i.split("/").slice(0,3).join("/"):i.split("/")[0]).split("?")[0]+r).concat(o,")");var s=d.split("/"),t=r.split("/");s.pop();for(var a=0,l=t;a<l.length;a++){var c=l[a];"."!==c&&(".."===c?s.pop():s.push(c))}return"url(".concat(o).concat(s.join("/")).concat(o,")")})}var b=/^[^ \t\n\r\u000c]+/,w=/^[, \t\n\r\u000c]+/;function E(e,t){return t&&""!==t.trim()?((e=e.createElement("a")).href=t,e.href):t}function le(){var e=document.createElement("a");return e.href="",e.href}function ce(e,t,r,n){{if("src"===r||"href"===r&&n&&("use"!==t||"#"!==n[0])||"xlink:href"===r&&n&&"#"!==n[0]||"background"===r&&n&&("table"===t||"td"===t||"th"===t))return E(e,n);if("srcset"===r&&n){var o=e,i=n;if(""===i.trim())return i;var s=0;function a(e){var e=e.exec(i.substring(s));return e?(e=e[0],s+=e.length,e):""}for(var l=[];a(w),!(s>=i.length);)if(","===(d=a(b)).slice(-1))d=E(o,d.substring(0,d.length-1)),l.push(d);else for(var c="",d=E(o,d),u=!1;;){var h=i.charAt(s);if(""===h){l.push((d+c).trim());break}if(u)")"===h&&(u=!1);else{if(","===h){s+=1,l.push((d+c).trim());break}"("===h&&(u=!0)}c+=h,s+=1}return l.join(", ")}return"style"===r&&n?ae(n,le()):"object"===t&&"data"===r&&n?E(e,n):n}}function T(e,t,r){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE)for(var n=e.classList.length;n--;){var o=e.classList[n];if(t.test(o))return!0}return!!r&&T(e.parentNode,t,r)}function de(e,t,r){e=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null!==e){if("string"==typeof t){if(e.classList.contains(t)||e.closest(".".concat(t)))return 1}else if(T(e,t,!0))return 1;return r&&(e.matches(r)||e.closest(r))}}function ue(e,t){var r=t.doc,n=t.mirror,o=t.blockClass,i=t.blockSelector,s=t.maskTextClass,a=t.maskTextSelector,l=t.inlineStylesheet,c=t.maskInputOptions,d=void 0===c?{}:c,u=t.maskTextFn,h=t.maskInputFn,c=t.dataURLOptions,p=void 0===c?{}:c,m=t.inlineImages,F=t.recordCanvas,P=t.keepIframeSrcFn,c=t.newlyAddedElement,W=void 0!==c&&c,f=(t=r,!(c=n).hasNode(t)||1===(c=c.getId(t))?void 0:c);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:j.Document,childNodes:[],compatMode:e.compatMode}:{type:j.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:j.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:f};case e.ELEMENT_NODE:for(var y,g,v=e,S=(R={doc:r,blockClass:o,blockSelector:i,inlineStylesheet:l,maskInputOptions:d,maskInputFn:h,dataURLOptions:p,inlineImages:m,recordCanvas:F,keepIframeSrcFn:P,newlyAddedElement:W,rootId:f}).doc,b=R.blockClass,w=R.blockSelector,E=R.inlineStylesheet,N=void 0===(N=R.maskInputOptions)?{}:N,C=R.maskInputFn,I=void 0===(T=R.dataURLOptions)?{}:T,T=R.inlineImages,M=R.recordCanvas,U=R.keepIframeSrcFn,D=void 0!==(D=R.newlyAddedElement)&&D,R=R.rootId,b=function(e,t,r){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var n=e.classList.length;n--;){var o=e.classList[n];if(t.test(o))return!0}return!!r&&e.matches(r)}(v,b,w),k=function(e){return e instanceof HTMLFormElement?"form":(e=e.tagName.toLowerCase().trim(),oe.test(e)?"div":e)}(v),x={},V=v.attributes.length,O=0;O<V;O++){var L=v.attributes[O];x[L.name]=ce(S,k,L.name,L.value)}return"link"===k&&E&&(w=Array.from(S.styleSheets).find(function(e){return e.href===v.href}),_=null,_=w?G(w):_)&&(delete x.rel,delete x.href,x._cssText=ae(_,w.href)),"style"===k&&v.sheet&&!(v.innerText||v.textContent||"").trim().length&&(_=G(v.sheet))&&(x._cssText=ae(_,le())),"input"!==k&&"textarea"!==k&&"select"!==k||(E=v.value,w=v.checked,"radio"!==x.type&&"checkbox"!==x.type&&"submit"!==x.type&&"button"!==x.type&&E?x.value=z({type:x.type,tagName:k,value:E,maskInputOptions:N,maskInputFn:C}):w&&(x.checked=w)),"option"===k&&(v.selected&&!N.select?x.selected=!0:delete x.selected),"canvas"===k&&M&&("2d"===v.__context?function(e){var t=e.getContext("2d");if(t)for(var r=0;r<e.width;r+=50)for(var n=0;n<e.height;n+=50){var o=t.getImageData,o=ne in o?o[ne]:o;if(new Uint32Array(o.call(t,r,n,Math.min(50,e.width-r),Math.min(50,e.height-n)).data.buffer).some(function(e){return 0!==e}))return}return 1}(v)||(x.rr_dataURL=v.toDataURL(I.type,I.quality)):"__context"in v||(_=v.toDataURL(I.type,I.quality),(E=document.createElement("canvas")).width=v.width,E.height=v.height,C=E.toDataURL(I.type,I.quality),_!==C&&(x.rr_dataURL=_))),"img"===k&&T&&(B||(B=S.createElement("canvas"),se=B.getContext("2d")),g=(y=v).crossOrigin,y.crossOrigin="anonymous",w=function(){try{B.width=y.naturalWidth,B.height=y.naturalHeight,se.drawImage(y,0,0),x.rr_dataURL=B.toDataURL(I.type,I.quality)}catch(e){console.warn("Cannot inline img src=".concat(y.currentSrc,"! Error: ").concat(e))}g?x.crossOrigin=g:y.removeAttribute("crossorigin")},y.complete&&0!==y.naturalWidth?w():y.onload=w),"audio"!==k&&"video"!==k||(x.rr_mediaState=v.paused?"paused":"played",x.rr_mediaCurrentTime=v.currentTime),D||(v.scrollLeft&&(x.rr_scrollLeft=v.scrollLeft),v.scrollTop&&(x.rr_scrollTop=v.scrollTop)),b&&(N=v.getBoundingClientRect(),M=N.width,E=N.height,x={class:x.class,rr_width:"".concat(M,"px"),rr_height:"".concat(E,"px")}),"iframe"!==k||U(x.src)||(v.contentDocument||(x.rr_src=x.src),delete x.src),{type:j.Element,tagName:k,attributes:x,childNodes:[],isSVG:function(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}(v)||void 0,needBlock:b,rootId:R};case e.TEXT_NODE:var A,C=e,T=(_={maskTextClass:s,maskTextSelector:a,maskTextFn:u,rootId:f}).maskTextClass,w=_.maskTextSelector,D=_.maskTextFn,_=_.rootId,N=C.parentNode&&C.parentNode.tagName,M=C.textContent,E="STYLE"===N||void 0,N="SCRIPT"===N||void 0;if(E&&M){try{C.nextSibling||C.previousSibling||null!=(A=C.parentNode.sheet)&&A.cssRules&&(M=function(e){return e.cssRules?Array.from(e.cssRules).map(function(e){return e.cssText||""}).join(""):""}(C.parentNode.sheet))}catch(e){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(e),C)}M=ae(M,le())}return N&&(M="SCRIPT_PLACEHOLDER"),!E&&!N&&M&&de(C,T,w)&&(M=D?D(M):M.replace(/[\S]/g,"*")),{type:j.Text,textContent:M||"",isStyle:E,rootId:_};case e.CDATA_SECTION_NODE:return{type:j.CDATA,textContent:"",rootId:f};case e.COMMENT_NODE:return{type:j.Comment,textContent:e.textContent||"",rootId:f};default:return!1}}function L(e){return void 0===e?"":e.toLowerCase()}function H(t,e){var r=e.doc,n=e.mirror,o=e.blockClass,i=e.blockSelector,s=e.maskTextClass,a=e.maskTextSelector,l=e.skipChild,l=void 0!==l&&l,c=e.inlineStylesheet,d=void 0===c||c,c=e.maskInputOptions,u=void 0===c?{}:c,h=e.maskTextFn,p=e.maskInputFn,m=e.slimDOMOptions,c=e.dataURLOptions,f=void 0===c?{}:c,c=e.inlineImages,y=void 0!==c&&c,c=e.recordCanvas,g=void 0!==c&&c,v=e.onSerialize,S=e.onIframeLoad,c=e.iframeLoadTimeout,b=void 0===c?5e3:c,w=e.onStylesheetLoad,c=e.stylesheetLoadTimeout,E=void 0===c?5e3:c,c=e.keepIframeSrcFn,N=void 0===c?function(){return!1}:c,c=e.newlyAddedElement,e=e.preserveWhiteSpace,C=void 0===e||e,e=ue(t,{doc:r,mirror:n,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:p,dataURLOptions:f,inlineImages:y,recordCanvas:g,keepIframeSrcFn:N,newlyAddedElement:void 0!==c&&c});if(!e)return console.warn(t,"not serialized"),null;var I=n.hasNode(t)?n.getId(t):(c=e,(I=m).comment&&c.type===j.Comment||c.type===j.Element&&(I.script&&("script"===c.tagName||"link"===c.tagName&&"preload"===c.attributes.rel&&"script"===c.attributes.as||"link"===c.tagName&&"prefetch"===c.attributes.rel&&"string"==typeof c.attributes.href&&c.attributes.href.endsWith(".js"))||I.headFavicon&&("link"===c.tagName&&"shortcut icon"===c.attributes.rel||"meta"===c.tagName&&(L(c.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===L(c.attributes.name)||"icon"===L(c.attributes.rel)||"apple-touch-icon"===L(c.attributes.rel)||"shortcut icon"===L(c.attributes.rel)))||"meta"===c.tagName&&(I.headMetaDescKeywords&&L(c.attributes.name).match(/^description|keywords$/)||I.headMetaSocial&&(L(c.attributes.property).match(/^(og|twitter|fb):/)||L(c.attributes.name).match(/^(og|twitter):/)||"pinterest"===L(c.attributes.name))||I.headMetaRobots&&("robots"===L(c.attributes.name)||"googlebot"===L(c.attributes.name)||"bingbot"===L(c.attributes.name))||I.headMetaHttpEquiv&&void 0!==c.attributes["http-equiv"]||I.headMetaAuthorship&&("author"===L(c.attributes.name)||"generator"===L(c.attributes.name)||"framework"===L(c.attributes.name)||"publisher"===L(c.attributes.name)||"progid"===L(c.attributes.name)||L(c.attributes.property).match(/^article:/)||L(c.attributes.property).match(/^product:/))||I.headMetaVerification&&("google-site-verification"===L(c.attributes.name)||"yandex-verification"===L(c.attributes.name)||"csrf-token"===L(c.attributes.name)||"p:domain_verify"===L(c.attributes.name)||"verify-v1"===L(c.attributes.name)||"verification"===L(c.attributes.name)||"shopify-checkout-api-token"===L(c.attributes.name))))||!C&&e.type===j.Text&&!e.isStyle&&!e.textContent.replace(/^\s+|\s+$/gm,"").length?ie:V++),T=Object.assign(e,{id:I});if(n.add(t,T),I===ie)return null;v&&v(t);c=!l;if(T.type===j.Element&&(c=c&&!T.needBlock,delete T.needBlock,e=t.shadowRoot)&&U(e)&&(T.isShadowHost=!0),(T.type===j.Document||T.type===j.Element)&&c){m.headWhitespace&&T.type===j.Element&&"head"===T.tagName&&(C=!1);for(var M,D={doc:r,mirror:n,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,skipChild:l,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:m,dataURLOptions:f,inlineImages:y,recordCanvas:g,preserveWhiteSpace:C,onSerialize:v,onIframeLoad:S,iframeLoadTimeout:b,onStylesheetLoad:w,stylesheetLoadTimeout:E,keepIframeSrcFn:N},R=0,k=Array.from(t.childNodes);R<k.length;R++)(M=H(k[R],D))&&T.childNodes.push(M);if(P(t)&&t.shadowRoot)for(var x=0,O=Array.from(t.shadowRoot.childNodes);x<O.length;x++)(M=H(O[x],D))&&(U(t.shadowRoot)&&(M.isShadow=!0),T.childNodes.push(M))}return t.parentNode&&W(t.parentNode)&&U(t.parentNode)&&(T.isShadow=!0),T.type===j.Element&&"iframe"===T.tagName&&function(e,t,r){var n=e.contentWindow;if(n){var o,i,s=!1;try{i=n.document.readyState}catch{return}if("complete"===i)return n.location.href!==(i="about:blank")||e.src===i||""===e.src?(setTimeout(t,0),e.addEventListener("load",t)):e.addEventListener("load",t);o=setTimeout(function(){s||(t(),s=!0)},r),e.addEventListener("load",function(){clearTimeout(o),s=!0,t()})}}(t,function(){var e=t.contentDocument;e&&S&&(e=H(e,{doc:e,mirror:n,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:m,dataURLOptions:f,inlineImages:y,recordCanvas:g,preserveWhiteSpace:C,onSerialize:v,onIframeLoad:S,iframeLoadTimeout:b,onStylesheetLoad:w,stylesheetLoadTimeout:E,keepIframeSrcFn:N}))&&S(t,e)},b),T.type===j.Element&&"link"===T.tagName&&"stylesheet"===T.attributes.rel&&function(e,t,r){var n,o,i=!1;try{n=e.sheet}catch{return}n||(o=setTimeout(function(){i||(t(),i=!0)},r),e.addEventListener("load",function(){clearTimeout(o),i=!0,t()}))}(t,function(){var e;w&&(e=H(t,{doc:r,mirror:n,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:m,dataURLOptions:f,inlineImages:y,recordCanvas:g,preserveWhiteSpace:C,onSerialize:v,onIframeLoad:S,iframeLoadTimeout:b,onStylesheetLoad:w,stylesheetLoadTimeout:E,keepIframeSrcFn:N}))&&w(t,e)},E),T}var M=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function D(n,r){void 0===r&&(r={});var o=1,i=1;function s(e){var t=e.match(/\n/g),t=(t&&(o+=t.length),e.lastIndexOf(`
`));i=-1===t?i+e.length:e.length-t}function a(){var t={line:o,column:i};return function(e){return e.position=new l(t),f(),e}}var l=function(e){this.start=e,this.end={line:o,column:i},this.source=r.source},c=(l.prototype.content=n,[]);function d(e){var t=new Error("".concat(r.source||"",":").concat(o,":").concat(i,": ").concat(e));if(t.reason=e,t.filename=r.source,t.line=o,t.column=i,t.source=n,!r.silent)throw t;c.push(t)}function u(){return m(/^{\s*/)}function h(){return m(/^}/)}function p(){var e,t,r=[];for(f(),y(r);n.length&&"}"!==n.charAt(0)&&(e=function(){if("@"===n[0])return function(){var e=a(),t=m(/^@([-\w]+)?keyframes\s*/);if(t){var r=t[1];if(!(t=m(/^([-\w]+)\s*/)))return d("@keyframes missing name");t=t[1];if(!u())return d("@keyframes missing '{'");for(var n,o=y();n=function(){for(var e,t=[],r=a();e=m(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),m(/^,\s*/);if(t.length)return r({type:"keyframe",values:t,declarations:b()})}();)o.push(n),o=o.concat(y());return h()?e({type:"keyframes",name:t,vendor:r,keyframes:o}):d("@keyframes missing '}'")}}()||function(){var e=a(),t=m(/^@media *([^{]+)/);{var r;if(t)return t=C(t[1]),u()?(r=y().concat(p()),h()?e({type:"media",media:t,rules:r}):d("@media missing '}'")):d("@media missing '{'")}}()||function(){var e=a(),t=m(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(t)return e({type:"custom-media",name:C(t[1]),media:C(t[2])})}()||function(){var e=a(),t=m(/^@supports *([^{]+)/);{var r;if(t)return t=C(t[1]),u()?(r=y().concat(p()),h()?e({type:"supports",supports:t,rules:r}):d("@supports missing '}'")):d("@supports missing '{'")}}()||w()||E()||N()||function(){var e=a(),t=m(/^@([-\w]+)?document *([^{]+)/);{var r,n;if(t)return r=C(t[1]),t=C(t[2]),u()?(n=y().concat(p()),h()?e({type:"document",document:t,vendor:r,rules:n}):d("@document missing '}'")):d("@document missing '{'")}}()||function(){var e=a();if(m(/^@page */)){var t=v()||[];if(!u())return d("@page missing '{'");for(var r,n=y();r=S();)n.push(r),n=n.concat(y());return h()?e({type:"page",selectors:t,declarations:n}):d("@page missing '}'")}}()||function(){var e=a();{var t;if(m(/^@host\s*/))return u()?(t=y().concat(p()),h()?e({type:"host",rules:t}):d("@host missing '}'")):d("@host missing '{'")}}()||function(){var e=a();if(m(/^@font-face\s*/)){if(!u())return d("@font-face missing '{'");for(var t,r=y();t=S();)r.push(t),r=r.concat(y());return h()?e({type:"font-face",declarations:r}):d("@font-face missing '}'")}}()}()||(t=e=void 0,e=a(),(t=v())?(y(),e({type:"rule",selectors:t,declarations:b()})):d("selector missing")));)!1!==e&&(r.push(e),y(r));return r}function m(e){var t,e=e.exec(n);if(e)return s(t=e[0]),n=n.slice(t.length),e}function f(){m(/^\s*/)}function y(e){void 0===e&&(e=[]);for(var t;t=g();)!1!==t&&e.push(t),g();return e}function g(){var e=a();if("/"===n.charAt(0)&&"*"===n.charAt(1)){for(var t,r=2;""!==n.charAt(r)&&("*"!==n.charAt(r)||"/"!==n.charAt(r+1));)++r;return""===n.charAt((r+=2)-1)?d("End of comment missing"):(t=n.slice(2,r-2),i+=2,s(t),n=n.slice(r),i+=2,e({type:"comment",comment:t}))}}function v(){var e=m(/^([^{]+)/);if(e)return C(e[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(e){return e.replace(/,/g,"‌")}).split(/\s*(?![^(]*\)),\s*/).map(function(e){return e.replace(/\u200C/g,",")})}function S(){var e,t=a(),r=m(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(r)return r=C(r[0]),m(/^:\s*/)?(e=m(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),t=t({type:"declaration",property:r.replace(M,""),value:e?C(e[0]).replace(M,""):""}),m(/^[;\s]*/),t):d("property missing ':'")}function b(){var e,t=[];if(!u())return d("missing '{'");for(y(t);e=S();)!1!==e&&(t.push(e),y(t)),S();return h()?t:d("missing '}'")}var e,w=t("import"),E=t("charset"),N=t("namespace");function t(n){var o=new RegExp("^@"+n+"\\s*([^;]+);");return function(){var e,t=a(),r=m(o);if(r)return(e={type:n})[n]=r[1].trim(),t(e)}}return function t(e,r){for(var n=e&&"string"==typeof e.type,o=n?e:r,i=0,s=Object.keys(e);i<s.length;i++){var a=s[i],a=e[a];Array.isArray(a)?a.forEach(function(e){t(e,o)}):a&&"object"==typeof a&&t(a,o)}return n&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:r||null}),e}((e=p(),{type:"stylesheet",stylesheet:{source:r.source,rules:e,parsingErrors:c}}))}function C(e){return e?e.replace(/^\s+|\s+$/g,""):""}var R={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};var k=/([^\\]):hover/,he=new RegExp(k.source,"g");function pe(e,t){var r,n=t?.stylesWithHoverClass.get(e);return n||(!(n=D(e,{silent:!0})).stylesheet||(r=[],n.stylesheet.rules.forEach(function(e){"selectors"in e&&(e.selectors||[]).forEach(function(e){k.test(e)&&r.push(e)})}),0===r.length)?e:(n=new RegExp(r.filter(function(e,t){return r.indexOf(e)===t}).sort(function(e,t){return t.length-e.length}).map(function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).join("|"),"g"),n=e.replace(n,function(e){var t=e.replace(he,"$1.\\:hover");return"".concat(e,", ").concat(t)}),t?.stylesWithHoverClass.set(e,n),n))}function me(){return{stylesWithHoverClass:new Map}}function fe(o,e){var t,r,n=e.doc,i=e.hackCss,s=e.cache;switch(o.type){case j.Document:return n.implementation.createDocument(null,"",null);case j.DocumentType:return n.implementation.createDocumentType(o.name||"html",o.publicId,o.systemId);case j.Element:var a,l=r="link"===(r=R[(t=o).tagName]||t.tagName)&&t.attributes._cssText?"style":r,c=o.isSVG?n.createElementNS("http://www.w3.org/2000/svg",l):n.createElement(l),d={};for(a in o.attributes)if(Object.prototype.hasOwnProperty.call(o.attributes,a)){var u=o.attributes[a];if("option"!==l||"selected"!==a||!1!==u){if(!0===u&&(u=""),a.startsWith("rr_")){d[a]=u;continue}var h="textarea"===l&&"value"===a,p="style"===l&&"_cssText"===a;if(p&&i&&"string"==typeof u&&(u=pe(u,s)),(h||p)&&"string"==typeof u){for(var h=n.createTextNode(u),m=0,f=Array.from(c.childNodes);m<f.length;m++){var y=f[m];y.nodeType===c.TEXT_NODE&&c.removeChild(y)}c.appendChild(h);continue}try{if(o.isSVG&&"xlink:href"===a)c.setAttributeNS("http://www.w3.org/1999/xlink",a,u.toString());else if("onload"===a||"onclick"===a||"onmouse"===a.substring(0,7))c.setAttribute("_"+a,u.toString());else{if("meta"===l&&"Content-Security-Policy"===o.attributes["http-equiv"]&&"content"===a){c.setAttribute("csp-content",u.toString());continue}"link"===l&&"preload"===o.attributes.rel&&"script"===o.attributes.as||"link"===l&&"prefetch"===o.attributes.rel&&"string"==typeof o.attributes.href&&o.attributes.href.endsWith(".js")||("img"===l&&o.attributes.srcset&&o.attributes.rr_dataURL?c.setAttribute("rrweb-original-srcset",o.attributes.srcset):c.setAttribute(a,u.toString()))}}catch{}}}for(var g in d)!function(e){var t,r,n=d[e];if("canvas"===l&&"rr_dataURL"===e?((t=document.createElement("img")).onload=function(){var e=c.getContext("2d");e&&e.drawImage(t,0,0,t.width,t.height)},t.src=n.toString(),c.RRNodeType&&(c.rr_dataURL=n.toString())):"img"!==l||"rr_dataURL"!==e||(r=c).currentSrc.startsWith("data:")||(r.setAttribute("rrweb-original-src",o.attributes.src),r.src=n.toString()),"rr_width"===e)c.style.width=n.toString();else if("rr_height"===e)c.style.height=n.toString();else if("rr_mediaCurrentTime"===e&&"number"==typeof n)c.currentTime=n;else if("rr_mediaState"===e)switch(n){case"played":c.play().catch(function(e){return console.warn("media playback error",e)});break;case"paused":c.pause()}}(g);if(o.isShadowHost)if(c.shadowRoot)for(;c.shadowRoot.firstChild;)c.shadowRoot.removeChild(c.shadowRoot.firstChild);else c.attachShadow({mode:"open"});return c;case j.Text:return n.createTextNode(o.isStyle&&i?pe(o.textContent,s):o.textContent);case j.CDATA:return n.createCDATASection(o.textContent);case j.Comment:return n.createComment(o.textContent);default:return null}}function ye(e,t){var r=t.doc,n=t.mirror,o=t.skipChild,o=void 0!==o&&o,i=t.hackCss,s=void 0===i||i,a=t.afterAppend,l=t.cache,c=fe(e,{doc:r,hackCss:s,cache:l});if(!c)return null;if(e.rootId&&n.getNode(e.rootId)!==r&&n.replace(e.rootId,r),e.type===j.Document&&(r.close(),r.open(),"BackCompat"===e.compatMode&&e.childNodes&&e.childNodes[0].type!==j.DocumentType&&(e.childNodes[0].type===j.Element&&"xmlns"in e.childNodes[0].attributes&&"http://www.w3.org/1999/xhtml"===e.childNodes[0].attributes.xmlns?r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),c=r),n.add(c,e),(e.type===j.Document||e.type===j.Element)&&!o)for(var d=0,u=e.childNodes;d<u.length;d++){var h=u[d],p=ye(h,{doc:r,mirror:n,skipChild:!1,hackCss:s,afterAppend:a,cache:l});p?((h.isShadow&&P(c)&&c.shadowRoot?c.shadowRoot:c).appendChild(p),a&&a(p,h.id)):console.warn("Failed to rebuild",h)}return c}function ge(e,t){for(var r=0,n=e.getIds();r<n.length;r++){var o=n[r];e.has(o)&&(o=e.getNode(o),t(o))}}function ve(e,t){var r=t.doc,i=t.onVisit,n=t.hackCss,n=void 0===n||n,o=t.afterAppend,s=t.cache,t=t.mirror,a=void 0===t?new re:t;ye(e,{doc:r,mirror:a,skipChild:!1,hackCss:n,afterAppend:o,cache:s});ge(a,function(e){i&&i(e);var t=a.getMeta(e);if(t?.type===j.Element){var r,n,o=e;for(r in t.attributes)Object.prototype.hasOwnProperty.call(t.attributes,r)&&r.startsWith("rr_")&&(n=t.attributes[r],"rr_scrollLeft"===r&&(o.scrollLeft=n),"rr_scrollTop"===r)&&(o.scrollTop=n)}})}function Y(e,t,r=document){const n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}const n=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;function x(o,i,s={}){let a=null,l=0;return function(...e){var t=Date.now();l||!1!==s.leading||(l=t);const r=i-(t-l),n=this;r<=0||i<r?(a&&(clearTimeout(a),a=null),l=t,o.apply(n,e)):a||!1===s.trailing||(a=setTimeout(()=>{l=!1===s.leading?0:Date.now(),a=null,o.apply(n,e)},r))}}function Se(e,t,r,n,o=window){const i=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,n?r:{set(e){setTimeout(()=>{r.set.call(this,e)},0),i&&i.set&&i.set.call(this,e)}}),()=>Se(e,t,i||{},!0)}function O(e,t,r){try{if(!(t in e))return()=>{};const n=e[t],o=r(n);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:n}})),e[t]=o,()=>{e[t]=n}}catch{return()=>{}}}function be(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function we(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function A(e,t,r,n){if(!e)return!1;var o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!o)return!1;if("string"==typeof t){if(o.classList.contains(t)||n&&null!==o.closest("."+t))return!0}else if(T(o,t,n))return!0;return!(!r||!(e.matches(r)||n&&null!==o.closest(r)))}function Ee(e,t){return-1!==t.getId(e)}function Ne(e,t){return t.getId(e)===ie}function Ce(e,t){var r;return!W(e)&&(r=t.getId(e),!t.has(r)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||Ce(e.parentNode,t)))}function Ie(e){return Boolean(e.changedTouches)}function Te(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}function Me(e){const r={},t=(e,t)=>{t={value:e,parent:t,children:[]};return r[e.node.id]=t},n=[];for(const a of e){var o,{nextId:i,parentId:s}=a;i&&i in r?(i=r[i]).parent?(o=i.parent.children.indexOf(i),i.parent.children.splice(o,0,t(a,i.parent))):(o=n.indexOf(i),n.splice(o,0,t(a,null))):s in r?(i=r[s]).children.push(t(a,i)):n.push(t(a,null))}return n}function De(t,r){r(t.value);for(let e=t.children.length-1;0<=e;e--)De(t.children[e],r)}function X(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function Re(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function ke(e,t){var r,e=null==(e=null==(e=e.ownerDocument)?void 0:e.defaultView)?void 0:e.frameElement;return e&&e!==t?(r=e.getBoundingClientRect(),t=ke(e,t),e=r.height/e.clientHeight,{x:r.x*t.relativeScale+t.x,y:r.y*t.relativeScale+t.y,relativeScale:e,absoluteScale:t.absoluteScale*e}):{x:0,y:0,relativeScale:1,absoluteScale:1}}function Z(e){return Boolean(e?.shadowRoot)}function s(e,t){e=e[t[0]];return 1===t.length?e:s(e.cssRules[t[1]].cssRules,t.slice(2))}function xe(e){var e=[...e],t=e.pop();return{positions:e,index:t}}function Oe(t){var r=new Set,n=[];for(let e=t.length;e--;){var o=t[e];r.has(o.id)||(n.push(o),r.add(o.id))}return n}e.mirror={map:{},getId(){return console.error(n),-1},getNode(){return console.error(n),null},removeNodeFromMap(){console.error(n)},has(){return console.error(n),!1},reset(){console.error(n)}},typeof window<"u"&&window.Proxy&&window.Reflect&&(e.mirror=new Proxy(e.mirror,{get(e,t,r){return"map"===t&&console.error(n),Reflect.get(e,t,r)}}));class Le{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){return null!=(e=this.styleIDMap.get(e))?e:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let r;return r=void 0===t?this.id++:t,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}var r=Object.freeze({__proto__:null,on:Y,get _mirror(){return e.mirror},throttle:x,hookSetter:Se,patch:O,getWindowHeight:be,getWindowWidth:we,isBlocked:A,isSerialized:Ee,isIgnored:Ne,isAncestorRemoved:Ce,isTouchEvent:Ie,polyfill:Te,queueToResolveTrees:Me,iterateResolveTree:De,isSerializedIframe:X,isSerializedStylesheet:Re,getBaseDimension:ke,hasShadowRoot:Z,getNestedRule:s,getPositionsAndIndex:xe,uniqueTextMutations:Oe,StyleSheetMirror:Le}),K=((l=K||{})[l.DomContentLoaded=0]="DomContentLoaded",l[l.Load=1]="Load",l[l.FullSnapshot=2]="FullSnapshot",l[l.IncrementalSnapshot=3]="IncrementalSnapshot",l[l.Meta=4]="Meta",l[l.Custom=5]="Custom",l[l.Plugin=6]="Plugin",l),J=((l=J||{})[l.Mutation=0]="Mutation",l[l.MouseMove=1]="MouseMove",l[l.MouseInteraction=2]="MouseInteraction",l[l.Scroll=3]="Scroll",l[l.ViewportResize=4]="ViewportResize",l[l.Input=5]="Input",l[l.TouchMove=6]="TouchMove",l[l.MediaInteraction=7]="MediaInteraction",l[l.StyleSheetRule=8]="StyleSheetRule",l[l.CanvasMutation=9]="CanvasMutation",l[l.Font=10]="Font",l[l.Log=11]="Log",l[l.Drag=12]="Drag",l[l.StyleDeclaration=13]="StyleDeclaration",l[l.Selection=14]="Selection",l[l.AdoptedStyleSheet=15]="AdoptedStyleSheet",l),c=((l=c||{})[l.MouseUp=0]="MouseUp",l[l.MouseDown=1]="MouseDown",l[l.Click=2]="Click",l[l.ContextMenu=3]="ContextMenu",l[l.DblClick=4]="DblClick",l[l.Focus=5]="Focus",l[l.Blur=6]="Blur",l[l.TouchStart=7]="TouchStart",l[l.TouchMove_Departed=8]="TouchMove_Departed",l[l.TouchEnd=9]="TouchEnd",l[l.TouchCancel=10]="TouchCancel",l),p=((l=p||{})[l["2D"]=0]="2D",l[l.WebGL=1]="WebGL",l[l.WebGL2=2]="WebGL2",l),_=((l=_||{})[l.Play=0]="Play",l[l.Pause=1]="Pause",l[l.Seeked=2]="Seeked",l[l.VolumeChange=3]="VolumeChange",l[l.RateChange=4]="RateChange",l),m=((l={}).Start="start",l.Pause="pause",l.Resume="resume",l.Resize="resize",l.Finish="finish",l.FullsnapshotRebuilded="fullsnapshot-rebuilded",l.LoadStylesheetStart="load-stylesheet-start",l.LoadStylesheetEnd="load-stylesheet-end",l.SkipStart="skip-start",l.SkipEnd="skip-end",l.MouseInteraction="mouse-interaction",l.EventCast="event-cast",l.CustomEvent="custom-event",l.Flush="flush",l.StateChange="state-change",l.PlayBack="play-back",l.Destroy="destroy",l);function Ae(e){return"__ln"in e}class _e{constructor(){this.length=0,this.head=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let e=0;e<t;e++)r=r?.next||null;return r}addNode(e){var t,r={value:e,previous:null,next:null};e.__ln=r,e.previousSibling&&Ae(e.previousSibling)?(t=e.previousSibling.__ln.next,r.next=t,r.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=r,t&&(t.previous=r)):e.nextSibling&&Ae(e.nextSibling)&&e.nextSibling.__ln.previous?(t=e.nextSibling.__ln.previous,r.previous=t,r.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=r,t&&(t.next=r)):(this.head&&(this.head.previous=r),r.next=this.head,this.head=r),this.length++}removeNode(e){var t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)}}class Fe{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(!this.frozen&&!this.locked){const a=[],l=new _e,c=e=>{let t=e,r=ie;for(;r===ie;)t=t&&t.nextSibling,r=t&&this.mirror.getId(t);return r},s=t=>{var e;let r=null,n=r=(null==(s=null==(s=t.getRootNode)?void 0:s.call(t))?void 0:s.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host?t.getRootNode().host:r;for(;(null==(e=null==(e=n?.getRootNode)?void 0:e.call(n))?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&n.getRootNode().host;)n=n.getRootNode().host;var o,i,s=!(this.doc.contains(t)||n&&this.doc.contains(n));if(t.parentNode&&!s)return s=W(t.parentNode)?this.mirror.getId(r):this.mirror.getId(t.parentNode),o=c(t),-1===s||-1===o?l.addNode(t):void((i=H(t,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{X(e,this.mirror)&&this.iframeManager.addIframe(e),Re(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),Z(t)&&this.shadowDomManager.addShadowRoot(t.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}}))&&a.push({parentId:s,nextId:o,node:i}))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const d of Array.from(this.movedSet.values()))We(this.removes,d,this.mirror)&&!this.movedSet.has(d.parentNode)||s(d);for(const u of Array.from(this.addedSet.values()))!Ue(this.droppedSet,u)&&!We(this.removes,u,this.mirror)||Ue(this.movedSet,u)?s(u):this.droppedSet.add(u);let e=null;for(;l.length;){let t=null;var r,n;if(!(t=e&&(r=this.mirror.getId(e.value.parentNode),n=c(e.value),-1!==r)&&-1!==n?e:t))for(let e=l.length-1;0<=e;e--){var o=l.get(e);if(o){var i=this.mirror.getId(o.value.parentNode);if(-1!==c(o.value)){if(-1!==i){t=o;break}i=o.value;if(i.parentNode&&i.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){i=i.parentNode.host;if(-1!==this.mirror.getId(i)){t=o;break}}}}}if(!t){for(;l.head;)l.removeNode(l.head.value);break}e=t.previous,l.removeNode(t.value),s(t.value)}var t={texts:this.texts.map(e=>({id:this.mirror.getId(e.node),value:e.value})).filter(e=>this.mirror.has(e.id)),attributes:this.attributes.map(e=>({id:this.mirror.getId(e.node),attributes:e.attributes})).filter(e=>this.mirror.has(e.id)),removes:this.removes,adds:a};(t.texts.length||t.attributes.length||t.removes.length||t.adds.length)&&(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(t))}},this.processMutation=n=>{if(!Ne(n.target,this.mirror))switch(n.type){case"characterData":var e=n.target.textContent;A(n.target,this.blockClass,this.blockSelector,!1)||e===n.oldValue||this.texts.push({value:de(n.target,this.maskTextClass,this.maskTextSelector)&&e?this.maskTextFn?this.maskTextFn(e):e.replace(/[\S]/g,"*"):e,node:n.target});break;case"attributes":{var r=n.target;let e=n.target.getAttribute(n.attributeName);if("value"===n.attributeName&&(e=z({maskInputOptions:this.maskInputOptions,tagName:n.target.tagName,type:n.target.getAttribute("type"),value:e,maskInputFn:this.maskInputFn})),A(n.target,this.blockClass,this.blockSelector,!1)||e===n.oldValue)return;let t=this.attributes.find(e=>e.node===n.target);if("IFRAME"===r.tagName&&"src"===n.attributeName&&!this.keepIframeSrcFn(e)){if(r.contentDocument)return;n.attributeName="rr_src"}if(t||(t={node:n.target,attributes:{}},this.attributes.push(t)),"style"===n.attributeName){var o=this.doc.createElement("span"),i=(n.oldValue&&o.setAttribute("style",n.oldValue),void 0!==t.attributes.style&&null!==t.attributes.style||(t.attributes.style={}),t.attributes.style);for(const l of Array.from(r.style)){var s=r.style.getPropertyValue(l),a=r.style.getPropertyPriority(l);s===o.style.getPropertyValue(l)&&a===o.style.getPropertyPriority(l)||(i[l]=""===a?s:[s,a])}for(const c of Array.from(o.style))""===r.style.getPropertyValue(c)&&(i[c]=!1)}else t.attributes[n.attributeName]=ce(this.doc,r.tagName,n.attributeName,e);break}case"childList":A(n.target,this.blockClass,this.blockSelector,!0)||(n.addedNodes.forEach(e=>this.genAdds(e,n.target)),n.removedNodes.forEach(e=>{var t=this.mirror.getId(e),r=W(n.target)?this.mirror.getId(n.target.host):this.mirror.getId(n.target);A(n.target,this.blockClass,this.blockSelector,!1)||Ne(e,this.mirror)||!Ee(e,this.mirror)||(this.addedSet.has(e)?(Pe(this.addedSet,e),this.droppedSet.add(e)):this.addedSet.has(n.target)&&-1===t||Ce(n.target,this.mirror)||(this.movedSet.has(e)&&this.movedMap[t+"@"+r]?Pe(this.movedSet,e):this.removes.push({parentId:r,id:t,isShadow:!(!W(n.target)||!U(n.target))||void 0})),this.mapRemoves.push(e))}))}},this.genAdds=(t,r)=>{if(this.mirror.hasNode(t)){if(Ne(t,this.mirror))return;this.movedSet.add(t);let e=null;(e=r&&this.mirror.hasNode(r)?this.mirror.getId(r):e)&&-1!==e&&(this.movedMap[this.mirror.getId(t)+"@"+e]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);A(t,this.blockClass,this.blockSelector,!1)||t.childNodes.forEach(e=>this.genAdds(e))}}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager"].forEach(e=>{this[e]=t[e]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Pe(t,e){t.delete(e),e.childNodes.forEach(e=>Pe(t,e))}function We(e,t,r){return 0!==e.length&&function e(t,r,n){const o=r["parentNode"];if(!o)return!1;const i=n.getId(o);return!!t.some(e=>e.id===i)||e(t,o,n)}(e,t,r)}function Ue(e,t){return 0!==e.size&&function e(t,r){const n=r["parentNode"];return!!n&&(!!t.has(n)||e(t,n))}(e,t)}var Ve=Object.defineProperty,je=Object.defineProperties,Be=Object.getOwnPropertyDescriptors,Ge=Object.getOwnPropertySymbols,ze=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable,Ye=(e,t,r)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Xe=(e,t)=>{for(var r in t=t||{})ze.call(t,r)&&Ye(e,r,t[r]);if(Ge)for(var r of Ge(t))He.call(t,r)&&Ye(e,r,t[r]);return e},Ze=(e,t)=>je(e,Be(t));const Q=[],Ke=typeof CSSGroupingRule<"u",Je=typeof CSSMediaRule<"u",Qe=typeof CSSSupportsRule<"u",qe=typeof CSSConditionRule<"u";function $e(e){try{if("composedPath"in e){var t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0];return e.target}catch{return e.target}}function et(e,t){var r=new Fe;Q.push(r),r.init(e);let n=window.MutationObserver||window.__rrMutationObserver;var o=null==(o=null==(e=window?.Zone)?void 0:e.__symbol__)?void 0:o.call(e,"MutationObserver"),e=new(n=o&&window[o]?window[o]:n)(r.processMutations.bind(r));return e.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),e}function tt({mouseInteractionCb:o,doc:r,mirror:i,blockClass:s,blockSelector:a,sampling:e}){if(!1===e.mouseInteraction)return()=>{};const t=!0===e.mouseInteraction||void 0===e.mouseInteraction?{}:e.mouseInteraction,l=[];return Object.keys(c).filter(e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==t[e]).forEach(e=>{var n,t=e.toLowerCase(),e=(n=e,e=>{var t,r=$e(e);A(r,s,a,!0)||(e=Ie(e)?e.changedTouches[0]:e)&&(r=i.getId(r),{clientX:e,clientY:t}=e,o({type:c[n],id:r,x:e,y:t}))});l.push(Y(t,e,r))}),()=>{l.forEach(e=>e())}}function rt({scrollCb:n,doc:o,mirror:i,blockClass:s,blockSelector:a,sampling:e}){return Y("scroll",x(e=>{var t,r,e=$e(e);e&&!A(e,s,a,!0)&&(t=i.getId(e),e===o?(r=o.scrollingElement||o.documentElement,n({id:t,x:r.scrollLeft,y:r.scrollTop})):n({id:t,x:e.scrollLeft,y:e.scrollTop}))},e.scroll||100),o)}function nt(e,t){e=Xe({},e);return t||delete e.userTriggered,e}const ot=["INPUT","TEXTAREA","SELECT"],it=new WeakMap;function st(e){var t,r;return e=e,t=[],Ke&&e.parentRule instanceof CSSGroupingRule||Je&&e.parentRule instanceof CSSMediaRule||Qe&&e.parentRule instanceof CSSSupportsRule||qe&&e.parentRule instanceof CSSConditionRule?(r=Array.from(e.parentRule.cssRules).indexOf(e),t.unshift(r)):e.parentStyleSheet&&(r=Array.from(e.parentStyleSheet.cssRules).indexOf(e),t.unshift(r)),t}function F(e,t,r){let n,o;return e?(e.ownerNode?n=t.getId(e.ownerNode):o=r.getId(e),{styleId:o,id:n}):{}}function at({mirror:e,stylesheetManager:r},t){let n=null;n="#document"===t.nodeName?e.getId(t):e.getId(t.host);const o="#document"===t.nodeName?null==(e=t.defaultView)?void 0:e.Document:null==(e=null==(e=t.ownerDocument)?void 0:e.defaultView)?void 0:e.ShadowRoot,i=Object.getOwnPropertyDescriptor(o?.prototype,"adoptedStyleSheets");return null!==n&&-1!==n&&o&&i?(Object.defineProperty(t,"adoptedStyleSheets",{configurable:i.configurable,enumerable:i.enumerable,get(){var e;return null==(e=i.get)?void 0:e.call(this)},set(e){var t=null==(t=i.set)?void 0:t.call(this,e);if(null!==n&&-1!==n)try{r.adoptStyleSheets(e,n)}catch{}return t}}),()=>{Object.defineProperty(t,"adoptedStyleSheets",{configurable:i.configurable,enumerable:i.enumerable,get:i.get,set:i.set})}):()=>{}}function lt(e,t={}){var r=e.doc.defaultView;if(!r)return()=>{};{var n=e,o=t;const{mutationCb:v,mousemoveCb:S,mouseInteractionCb:b,scrollCb:w,viewportResizeCb:E,inputCb:N,mediaInteractionCb:C,styleSheetRuleCb:I,styleDeclarationCb:T,canvasMutationCb:M,fontCb:D,selectionCb:R}=n;n.mutationCb=(...e)=>{o.mutation&&o.mutation(...e),v(...e)},n.mousemoveCb=(...e)=>{o.mousemove&&o.mousemove(...e),S(...e)},n.mouseInteractionCb=(...e)=>{o.mouseInteraction&&o.mouseInteraction(...e),b(...e)},n.scrollCb=(...e)=>{o.scroll&&o.scroll(...e),w(...e)},n.viewportResizeCb=(...e)=>{o.viewportResize&&o.viewportResize(...e),E(...e)},n.inputCb=(...e)=>{o.input&&o.input(...e),N(...e)},n.mediaInteractionCb=(...e)=>{o.mediaInteaction&&o.mediaInteaction(...e),C(...e)},n.styleSheetRuleCb=(...e)=>{o.styleSheetRule&&o.styleSheetRule(...e),I(...e)},n.styleDeclarationCb=(...e)=>{o.styleDeclaration&&o.styleDeclaration(...e),T(...e)},n.canvasMutationCb=(...e)=>{o.canvasMutation&&o.canvasMutation(...e),M(...e)},n.fontCb=(...e)=>{o.font&&o.font(...e),D(...e)},n.selectionCb=(...e)=>{o.selection&&o.selection(...e),R(...e)}}const i=et(e,e.doc),s=function({mousemoveCb:r,sampling:e,doc:t,mirror:o}){if(!1===e.mousemove)return()=>{};var n="number"==typeof e.mousemove?e.mousemove:50,e="number"==typeof e.mousemoveCallback?e.mousemoveCallback:500;let i=[],s;const a=x(e=>{const t=Date.now()-s;r(i.map(e=>(e.timeOffset-=t,e)),e),i=[],s=null},e),l=x(e=>{var t=$e(e),{clientX:r,clientY:n}=Ie(e)?e.changedTouches[0]:e;s=s||Date.now(),i.push({x:r,y:n,id:o.getId(t),timeOffset:Date.now()-s}),a(typeof DragEvent<"u"&&e instanceof DragEvent?J.Drag:e instanceof MouseEvent?J.MouseMove:J.TouchMove)},n,{trailing:!1}),c=[Y("mousemove",l,t),Y("touchmove",l,t),Y("drag",l,t)];return()=>{c.forEach(e=>e())}}(e),a=tt(e),l=rt(e),c=function({viewportResizeCb:r}){let n=-1,o=-1;return Y("resize",x(()=>{var e=be(),t=we();n===e&&o===t||(r({width:Number(t),height:Number(e)}),n=e,o=t)},200),window)}(e),d=function({inputCb:n,doc:i,mirror:o,blockClass:e,blockSelector:t,ignoreClass:s,maskInputOptions:a,maskInputFn:l,sampling:r,userTriggeredOnInput:c}){function d(r){let n=$e(r);r=r.isTrusted;if((n=n&&"OPTION"===n.tagName?n.parentElement:n)&&n.tagName&&!(ot.indexOf(n.tagName)<0)&&!A(n,e,t,!0)){var o=n.type;if(!n.classList.contains(s)){let e=n.value,t=!1;"radio"===o||"checkbox"===o?t=n.checked:(a[n.tagName.toLowerCase()]||a[o])&&(e=z({maskInputOptions:a,tagName:n.tagName,type:o,value:e,maskInputFn:l})),u(n,nt({text:e,isChecked:t,userTriggered:r},c));r=n.name;"radio"===o&&r&&t&&i.querySelectorAll(`input[type="radio"][name="${r}"]`).forEach(e=>{e!==n&&u(e,nt({text:e.value,isChecked:!t,userTriggered:!1},c))})}}}function u(e,t){var r=it.get(e);r&&r.text===t.text&&r.isChecked===t.isChecked||(it.set(e,t),r=o.getId(e),n(Ze(Xe({},t),{id:r})))}const h=("last"===r.input?["change"]:["input","change"]).map(e=>Y(e,d,i)),p=i.defaultView;var m;return p?(r=p.Object.getOwnPropertyDescriptor(p.HTMLInputElement.prototype,"value"),m=[[p.HTMLInputElement.prototype,"value"],[p.HTMLInputElement.prototype,"checked"],[p.HTMLSelectElement.prototype,"value"],[p.HTMLTextAreaElement.prototype,"value"],[p.HTMLSelectElement.prototype,"selectedIndex"],[p.HTMLOptionElement.prototype,"selected"]],r&&r.set&&h.push(...m.map(e=>Se(e[0],e[1],{set(){d({target:this})}},!1,p))),()=>{h.forEach(e=>e())}):()=>{h.forEach(e=>e())}}(e),u=function({mediaInteractionCb:s,blockClass:a,blockSelector:l,mirror:c,sampling:e}){const t=i=>x(e=>{var t,r,n,o,e=$e(e);e&&!A(e,a,l,!0)&&({currentTime:t,volume:r,muted:n,playbackRate:o}=e,s({type:i,id:c.getId(e),currentTime:t,volume:r,muted:n,playbackRate:o}))},e.media||500),r=[Y("play",t(_.Play)),Y("pause",t(_.Pause)),Y("seeked",t(_.Seeked)),Y("volumechange",t(_.VolumeChange)),Y("ratechange",t(_.RateChange))];return()=>{r.forEach(e=>e())}}(e),h=function({styleSheetRuleCb:i,mirror:s,stylesheetManager:a},{win:e}){const o=e.CSSStyleSheet.prototype.insertRule,n=(e.CSSStyleSheet.prototype.insertRule=function(e,t){var{id:r,styleId:n}=F(this,s,a.styleMirror);return(r&&-1!==r||n&&-1!==n)&&i({id:r,styleId:n,adds:[{rule:e,index:t}]}),o.apply(this,[e,t])},e.CSSStyleSheet.prototype.deleteRule);e.CSSStyleSheet.prototype.deleteRule=function(e){var{id:t,styleId:r}=F(this,s,a.styleMirror);return(t&&-1!==t||r&&-1!==r)&&i({id:t,styleId:r,removes:[{index:e}]}),n.apply(this,[e])};let l;e.CSSStyleSheet.prototype.replace&&(l=e.CSSStyleSheet.prototype.replace,e.CSSStyleSheet.prototype.replace=function(e){var{id:t,styleId:r}=F(this,s,a.styleMirror);return(t&&-1!==t||r&&-1!==r)&&i({id:t,styleId:r,replace:e}),l.apply(this,[e])});let c;e.CSSStyleSheet.prototype.replaceSync&&(c=e.CSSStyleSheet.prototype.replaceSync,e.CSSStyleSheet.prototype.replaceSync=function(e){var{id:t,styleId:r}=F(this,s,a.styleMirror);return(t&&-1!==t||r&&-1!==r)&&i({id:t,styleId:r,replaceSync:e}),c.apply(this,[e])});const t={},d=(Ke?t.CSSGroupingRule=e.CSSGroupingRule:(Je&&(t.CSSMediaRule=e.CSSMediaRule),qe&&(t.CSSConditionRule=e.CSSConditionRule),Qe&&(t.CSSSupportsRule=e.CSSSupportsRule)),{});return Object.entries(t).forEach(([o,e])=>{d[o]={insertRule:e.prototype.insertRule,deleteRule:e.prototype.deleteRule},e.prototype.insertRule=function(e,t){var{id:r,styleId:n}=F(this.parentStyleSheet,s,a.styleMirror);return(r&&-1!==r||n&&-1!==n)&&i({id:r,styleId:n,adds:[{rule:e,index:[...st(this),t||0]}]}),d[o].insertRule.apply(this,[e,t])},e.prototype.deleteRule=function(e){var{id:t,styleId:r}=F(this.parentStyleSheet,s,a.styleMirror);return(t&&-1!==t||r&&-1!==r)&&i({id:t,styleId:r,removes:[{index:[...st(this),e]}]}),d[o].deleteRule.apply(this,[e])}}),()=>{e.CSSStyleSheet.prototype.insertRule=o,e.CSSStyleSheet.prototype.deleteRule=n,l&&(e.CSSStyleSheet.prototype.replace=l),c&&(e.CSSStyleSheet.prototype.replaceSync=c),Object.entries(t).forEach(([e,t])=>{t.prototype.insertRule=d[e].insertRule,t.prototype.deleteRule=d[e].deleteRule})}}(e,{win:r}),p=at(e,e.doc),m=function({styleDeclarationCb:i,mirror:s,ignoreCSSAttributes:a,stylesheetManager:l},{win:e}){const c=e.CSSStyleDeclaration.prototype.setProperty,n=(e.CSSStyleDeclaration.prototype.setProperty=function(e,t,r){var n,o;return!a.has(e)&&({id:n,styleId:o}=F(null==(n=this.parentRule)?void 0:n.parentStyleSheet,s,l.styleMirror),n&&-1!==n||o&&-1!==o)&&i({id:n,styleId:o,set:{property:e,value:t,priority:r},index:st(this.parentRule)}),c.apply(this,[e,t,r])},e.CSSStyleDeclaration.prototype.removeProperty);return e.CSSStyleDeclaration.prototype.removeProperty=function(e){var t,r;return!a.has(e)&&({id:t,styleId:r}=F(null==(t=this.parentRule)?void 0:t.parentStyleSheet,s,l.styleMirror),t&&-1!==t||r&&-1!==r)&&i({id:t,styleId:r,remove:{property:e},index:st(this.parentRule)}),n.apply(this,[e])},()=>{e.CSSStyleDeclaration.prototype.setProperty=c,e.CSSStyleDeclaration.prototype.removeProperty=n}}(e,{win:r}),f=e.collectFonts?function({fontCb:r,doc:e}){const t=e.defaultView;if(!t)return()=>{};const n=[],o=new WeakMap,i=t.FontFace;return t.FontFace=function(e,t,r){var n=new i(e,t,r);return o.set(n,{family:e,buffer:"string"!=typeof t,descriptors:r,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),n},e=O(e.fonts,"add",function(e){return function(t){return setTimeout(()=>{var e=o.get(t);e&&(r(e),o.delete(t))},0),e.apply(this,[t])}}),n.push(()=>{t.FontFace=i}),n.push(e),()=>{n.forEach(e=>e())}}(e):()=>{},y=function(e){const{doc:l,mirror:c,blockClass:d,blockSelector:u,selectionCb:h}=e;let p=!0;return(e=()=>{var t=l.getSelection();if(!(!t||p&&t?.isCollapsed)){p=t.isCollapsed||!1;var r=[],n=t.rangeCount||0;for(let e=0;e<n;e++){var{startContainer:o,startOffset:i,endContainer:s,endOffset:a}=t.getRangeAt(e);A(o,d,u,!0)||A(s,d,u,!0)||r.push({start:c.getId(o),startOffset:i,end:c.getId(s),endOffset:a})}h({ranges:r})}})(),Y("selectionchange",e)}(e),g=[];for(const k of e.plugins)g.push(k.observer(k.callback,r,k.options));return()=>{Q.forEach(e=>e.reset()),i.disconnect(),s(),a(),l(),c(),d(),u(),h(),p(),m(),f(),y(),g.forEach(e=>e())}}class ct{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,r,n){r=r||this.getIdToRemoteIdMap(e),n=n||this.getRemoteIdToIdMap(e);let o=r.get(t);return o||(o=this.generateIdFn(),r.set(t,o),n.set(o,t)),o}getIds(t,e){const r=this.getIdToRemoteIdMap(t),n=this.getRemoteIdToIdMap(t);return e.map(e=>this.getId(t,e,r,n))}getRemoteId(e,t,r){r=r||this.getRemoteIdToIdMap(e);return"number"!=typeof t?t:r.get(t)||-1}getRemoteIds(t,e){const r=this.getRemoteIdToIdMap(t);return e.map(e=>this.getRemoteId(t,e,r))}reset(e){e?(this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)):(this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class dt{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new ct(y),this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new ct(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null!=(t=this.loadListener)&&t.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&0<e.contentDocument.adoptedStyleSheets.length&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){var t;"rrweb"===e.data.type&&e.source&&(t=this.crossOriginIframeMap.get(e.source))&&(t=this.transformCrossOriginEvent(t,e.data.event))&&this.wrappedEmit(t,e.data.isCheckout)}transformCrossOriginEvent(t,e){var r;switch(e.type){case K.FullSnapshot:return this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(e.data.node,t),{timestamp:e.timestamp,type:K.IncrementalSnapshot,data:{source:J.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:e.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case K.Meta:case K.Load:case K.DomContentLoaded:return!1;case K.Plugin:return e;case K.Custom:return this.replaceIds(e.data.payload,t,["id","parentId","previousId","nextId"]),e;case K.IncrementalSnapshot:switch(e.data.source){case J.Mutation:return e.data.adds.forEach(e=>{this.replaceIds(e,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(e.node,t)}),e.data.removes.forEach(e=>{this.replaceIds(e,t,["parentId","id"])}),e.data.attributes.forEach(e=>{this.replaceIds(e,t,["id"])}),e.data.texts.forEach(e=>{this.replaceIds(e,t,["id"])}),e;case J.Drag:case J.TouchMove:case J.MouseMove:return e.data.positions.forEach(e=>{this.replaceIds(e,t,["id"])}),e;case J.ViewportResize:return!1;case J.MediaInteraction:case J.MouseInteraction:case J.Scroll:case J.CanvasMutation:case J.Input:return this.replaceIds(e.data,t,["id"]),e;case J.StyleSheetRule:case J.StyleDeclaration:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleId"]),e;case J.Font:return e;case J.Selection:return e.data.ranges.forEach(e=>{this.replaceIds(e,t,["start","end"])}),e;case J.AdoptedStyleSheet:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleIds"]),null!=(r=e.data.styles)&&r.forEach(e=>{this.replaceStyleIds(e,t,["styleId"])}),e}}}replace(e,t,r,n){for(const o of n)!Array.isArray(t[o])&&"number"!=typeof t[o]||(Array.isArray(t[o])?t[o]=e.getIds(r,t[o]):t[o]=e.getId(r,t[o]));return t}replaceIds(e,t,r){return this.replace(this.crossOriginIframeMirror,e,t,r)}replaceStyleIds(e,t,r){return this.replace(this.crossOriginIframeStyleMirror,e,t,r)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id"]),"childNodes"in e&&e.childNodes.forEach(e=>{this.replaceIdOnNode(e,t)})}}var ut=Object.defineProperty,ht=Object.defineProperties,pt=Object.getOwnPropertyDescriptors,mt=Object.getOwnPropertySymbols,ft=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable,gt=(e,t,r)=>t in e?ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,vt=(e,t)=>{for(var r in t=t||{})ft.call(t,r)&&gt(e,r,t[r]);if(mt)for(var r of mt(t))yt.call(t,r)&&gt(e,r,t[r]);return e},St=(e,t)=>ht(e,pt(t));class bt{constructor(e){this.shadowDoms=new WeakSet,this.restorePatches=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror;const r=this;this.restorePatches.push(O(Element.prototype,"attachShadow",function(t){return function(e){e=t.call(this,e);return this.shadowRoot&&r.addShadowRoot(this.shadowRoot,this.ownerDocument),e}}))}addShadowRoot(e,t){U(e)&&!this.shadowDoms.has(e)&&(this.shadowDoms.add(e),et(St(vt({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e),rt(St(vt({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),setTimeout(()=>{e.adoptedStyleSheets&&0<e.adoptedStyleSheets.length&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),at({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e)},0))}observeAttachShadow(r){if(r.contentWindow){const n=this;this.restorePatches.push(O(r.contentWindow.HTMLElement.prototype,"attachShadow",function(t){return function(e){e=t.call(this,e);return this.shadowRoot&&n.addShadowRoot(this.shadowRoot,r.contentDocument),e}}))}}reset(){this.restorePatches.forEach(e=>e()),this.shadowDoms=new WeakSet}}for(var wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Et="u"<typeof Uint8Array?[]:new Uint8Array(256),Nt=0;Nt<wt.length;Nt++)Et[wt.charCodeAt(Nt)]=Nt;function Ct(e){for(var t=new Uint8Array(e),r=t.length,n="",o=0;o<r;o+=3)n=(n=(n=(n+=wt[t[o]>>2])+wt[(3&t[o])<<4|t[o+1]>>4])+wt[(15&t[o+1])<<2|t[o+2]>>6])+wt[63&t[o+2]];return r%3==2?n=n.substring(0,n.length-1)+"=":r%3==1&&(n=n.substring(0,n.length-2)+"=="),n}function It(e){for(var t,r,n,o,i=.75*e.length,s=e.length,a=0,i=("="===e[e.length-1]&&(i--,"="===e[e.length-2])&&i--,new ArrayBuffer(i)),l=new Uint8Array(i),c=0;c<s;c+=4)t=Et[e.charCodeAt(c)],r=Et[e.charCodeAt(c+1)],n=Et[e.charCodeAt(c+2)],o=Et[e.charCodeAt(c+3)],l[a++]=t<<2|r>>4,l[a++]=(15&r)<<4|n>>2,l[a++]=(3&n)<<6|63&o;return i}const Tt=new Map;const Mt=(t,r,n)=>{if(t&&(Rt(t,r)||"object"==typeof t)){r=function(e,t){let r=Tt.get(e);return r||(r=new Map,Tt.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}(n,t.constructor.name);let e=r.indexOf(t);return-1===e&&(e=r.length,r.push(t)),e}};const Dt=(e,t,r)=>[...e].map(e=>function t(e,r,n){var o;return e instanceof Array?e.map(e=>t(e,r,n)):null===e?e:e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray?{rr_type:e.constructor.name,args:[Object.values(e)]}:e instanceof ArrayBuffer?{rr_type:e.constructor.name,base64:Ct(e)}:e instanceof DataView?{rr_type:e.constructor.name,args:[t(e.buffer,r,n),e.byteOffset,e.byteLength]}:e instanceof HTMLImageElement?(o=e.src,{rr_type:e.constructor.name,src:o}):e instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:e.toDataURL()}:e instanceof ImageData?{rr_type:e.constructor.name,args:[t(e.data,r,n),e.width,e.height]}:Rt(e,r)||"object"==typeof e?{rr_type:e.constructor.name,index:Mt(e,r,n)}:e}(e,t,r)),Rt=(t,r)=>{var e=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(e=>"function"==typeof r[e]);return Boolean(e.find(e=>t instanceof r[e]))};function kt(e,n,o){const t=[];try{var r=O(e.HTMLCanvasElement.prototype,"getContext",function(r){return function(e,...t){return A(this,n,o,!0)||"__context"in this||(this.__context=e),r.apply(this,[e,...t])}});t.push(r)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{t.forEach(e=>e())}}function xt(e,n,o,i,s,t,a){var r=[];for(const d of Object.getOwnPropertyNames(e))if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(d))try{if("function"!=typeof e[d])continue;var l=O(e,d,function(r){return function(...e){var t=r.apply(this,e);return Mt(t,a,this),A(this.canvas,i,s,!0)||(e=Dt([...e],a,this),e={type:n,property:d,args:e},o(this.canvas,e)),t}});r.push(l)}catch{var c=Se(e,d,{set(e){o(this.canvas,{type:n,property:d,args:[e],setter:!0})}});r.push(c)}return r}function Ot(e,t,r){t=void 0===t?null:t,e=function(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),o=0,i=r.length;o<i;++o)n[o]=r.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}(e,void 0!==r&&r),r=e.indexOf(`
`,10)+1,e=e.substring(r)+(t?"//# sourceMappingURL="+t:""),r=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(r)}At=null,_t=!(Lt="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Zm9yKHZhciByPSJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvIixwPXR5cGVvZiBVaW50OEFycmF5PiJ1Ij9bXTpuZXcgVWludDhBcnJheSgyNTYpLGY9MDtmPHIubGVuZ3RoO2YrKylwW3IuY2hhckNvZGVBdChmKV09Zjt2YXIgdT1mdW5jdGlvbihzKXt2YXIgZT1uZXcgVWludDhBcnJheShzKSxuLGE9ZS5sZW5ndGgsdD0iIjtmb3Iobj0wO248YTtuKz0zKXQrPXJbZVtuXT4+Ml0sdCs9clsoZVtuXSYzKTw8NHxlW24rMV0+PjRdLHQrPXJbKGVbbisxXSYxNSk8PDJ8ZVtuKzJdPj42XSx0Kz1yW2VbbisyXSY2M107cmV0dXJuIGElMz09PTI/dD10LnN1YnN0cmluZygwLHQubGVuZ3RoLTEpKyI9IjphJTM9PT0xJiYodD10LnN1YnN0cmluZygwLHQubGVuZ3RoLTIpKyI9PSIpLHR9O2NvbnN0IGM9bmV3IE1hcCxsPW5ldyBNYXA7YXN5bmMgZnVuY3Rpb24gdihzLGUsbil7Y29uc3QgYT1gJHtzfS0ke2V9YDtpZigiT2Zmc2NyZWVuQ2FudmFzImluIGdsb2JhbFRoaXMpe2lmKGwuaGFzKGEpKXJldHVybiBsLmdldChhKTtjb25zdCB0PW5ldyBPZmZzY3JlZW5DYW52YXMocyxlKTt0LmdldENvbnRleHQoIjJkIik7Y29uc3QgZz1hd2FpdChhd2FpdCB0LmNvbnZlcnRUb0Jsb2IobikpLmFycmF5QnVmZmVyKCksZD11KGcpO3JldHVybiBsLnNldChhLGQpLGR9ZWxzZSByZXR1cm4iIn1jb25zdCBpPXNlbGY7aS5vbm1lc3NhZ2U9YXN5bmMgZnVuY3Rpb24ocyl7aWYoIk9mZnNjcmVlbkNhbnZhcyJpbiBnbG9iYWxUaGlzKXtjb25zdHtpZDplLGJpdG1hcDpuLHdpZHRoOmEsaGVpZ2h0OnQsZGF0YVVSTE9wdGlvbnM6Z309cy5kYXRhLGQ9dihhLHQsZyksaD1uZXcgT2Zmc2NyZWVuQ2FudmFzKGEsdCk7aC5nZXRDb250ZXh0KCIyZCIpLmRyYXdJbWFnZShuLDAsMCksbi5jbG9zZSgpO2NvbnN0IHc9YXdhaXQgaC5jb252ZXJ0VG9CbG9iKGcpLHk9dy50eXBlLGI9YXdhaXQgdy5hcnJheUJ1ZmZlcigpLG89dShiKTtpZighYy5oYXMoZSkmJmF3YWl0IGQ9PT1vKXJldHVybiBjLnNldChlLG8pLGkucG9zdE1lc3NhZ2Uoe2lkOmV9KTtpZihjLmdldChlKT09PW8pcmV0dXJuIGkucG9zdE1lc3NhZ2Uoe2lkOmV9KTtpLnBvc3RNZXNzYWdlKHtpZDplLHR5cGU6eSxiYXNlNjQ6byx3aWR0aDphLGhlaWdodDp0fSksYy5zZXQoZSxvKX1lbHNlIHJldHVybiBpLnBvc3RNZXNzYWdlKHtpZDpzLmRhdGEuaWR9KX19KSgpOwoK");var Lt,At,_t,Ft,Pt=function(e){return Ft=Ft||Ot(Lt,At,_t),new Worker(Ft,e)},Wt=Object.getOwnPropertySymbols,Ut=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable;class jt{constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};var{sampling:t="all",win:r,blockClass:n,blockSelector:o,recordCanvas:i,dataURLOptions:s}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,i&&"all"===t&&this.initCanvasMutationObserver(r,n,o),i&&"number"==typeof t&&this.initCanvasFPSObserver(t,r,n,o,{dataURLOptions:s})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(e,r,n,o,i){const t=kt(r,n,o),l=new Map,c=new Pt,s=(c.onmessage=e=>{var t,r,n,o=e.data["id"];l.set(o,!1),"base64"in e.data&&({base64:e,type:t,width:r,height:n}=e.data,this.mutationCb({id:o,type:p["2D"],commands:[{property:"clearRect",args:[0,0,r,n]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:e}],type:t}]},0,0]}]}))},1e3/e);let a=0,d;const u=()=>{const t=[];return r.document.querySelectorAll("canvas").forEach(e=>{A(e,n,o,!0)||t.push(e)}),t},h=e=>{d=(a&&e-a<s||(a=e,u().forEach(n=>{return e=this,s=null,a=function*(){var e,t,r=this.mirror.getId(n);l.get(r)||(l.set(r,!0),["webgl","webgl2"].includes(n.__context)&&!1===(null==(t=(e=n.getContext(n.__context))?.getContextAttributes())?void 0:t.preserveDrawingBuffer)&&e?.clear(e.COLOR_BUFFER_BIT),t=yield createImageBitmap(n),c.postMessage({id:r,bitmap:t,width:n.width,height:n.height,dataURLOptions:i.dataURLOptions},[t]))},new Promise((t,r)=>{var n=e=>{try{i(a.next(e))}catch(e){r(e)}},o=e=>{try{i(a.throw(e))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);i((a=a.apply(e,s)).next())});var e,s,a})),requestAnimationFrame(h))};d=requestAnimationFrame(h),this.resetObservers=()=>{t(),cancelAnimationFrame(d)}}initCanvasMutationObserver(e,t,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const n=kt(e,t,r),o=function(r,n,o,i){const e=[],t=Object.getOwnPropertyNames(n.CanvasRenderingContext2D.prototype);for(const l of t)try{if("function"!=typeof n.CanvasRenderingContext2D.prototype[l])continue;var s=O(n.CanvasRenderingContext2D.prototype,l,function(e){return function(...t){return A(this.canvas,o,i,!0)||setTimeout(()=>{var e=Dt([...t],n,this);r(this.canvas,{type:p["2D"],property:l,args:e})},0),e.apply(this,t)}});e.push(s)}catch{var a=Se(n.CanvasRenderingContext2D.prototype,l,{set(e){r(this.canvas,{type:p["2D"],property:l,args:[e],setter:!0})}});e.push(a)}return()=>{e.forEach(e=>e())}}(this.processMutation.bind(this),e,t,r),i=function(e,t,r,n){const o=[];return o.push(...xt(t.WebGLRenderingContext.prototype,p.WebGL,e,r,n,0,t)),typeof t.WebGL2RenderingContext<"u"&&o.push(...xt(t.WebGL2RenderingContext.prototype,p.WebGL2,e,r,n,0,t)),()=>{o.forEach(e=>e())}}(this.processMutation.bind(this),e,t,r,this.mirror);this.resetObservers=()=>{n(),o(),i()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=e=>{this.rafStamps.latestId=e,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,t)=>{var r=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,r)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,t){var r,n;this.frozen||this.locked||(n=this.pendingCanvasMutations.get(e))&&-1!==t&&(r=n.map(e=>{var t=e,r=["type"],n={};for(o in t)Ut.call(t,o)&&r.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&Wt)for(var o of Wt(t))r.indexOf(o)<0&&Vt.call(t,o)&&(n[o]=t[o]);return n}),n=n[0]["type"],this.mutationCb({id:t,type:n,commands:r}),this.pendingCanvasMutations.delete(e))}}class Bt{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new Le,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0!==e.length){var r,n={id:t,styleIds:[]},o=[];for(const i of e){let e;this.styleMirror.has(i)?e=this.styleMirror.getId(i):(e=this.styleMirror.add(i),r=Array.from(i.rules||CSSRule),o.push({styleId:e,rules:r.map((e,t)=>({rule:d(e),index:t}))})),n.styleIds.push(e)}0<o.length&&(n.styles=o),this.adoptedStyleSheetCb(n)}}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}var N,Gt=Object.defineProperty,zt=Object.defineProperties,Ht=Object.getOwnPropertyDescriptors,Yt=Object.getOwnPropertySymbols,Xt=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,Kt=(e,t,r)=>t in e?Gt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,q=(e,t)=>{for(var r in t=t||{})Xt.call(t,r)&&Kt(e,r,t[r]);if(Yt)for(var r of Yt(t))Zt.call(t,r)&&Kt(e,r,t[r]);return e},Jt=(e,t)=>zt(e,Ht(t));function $(e){return Jt(q({},e),{timestamp:Date.now()})}let ee,Qt,qt,$t=!1;const te=f();function o(F={}){const{emit:n,checkoutEveryNms:o,checkoutEveryNth:i,blockClass:w="rr-block",blockSelector:E=null,ignoreClass:P="rr-ignore",maskTextClass:N="rr-mask",maskTextSelector:C=null,inlineStylesheet:I=!0,maskAllInputs:W,maskInputOptions:e,slimDOMOptions:t,maskInputFn:r,maskTextFn:T,hooks:U,packFn:s,sampling:a={},dataURLOptions:M={},mousemoveWait:l,recordCanvas:D=!1,recordCrossOriginIframes:c=!1,userTriggeredOnInput:V=!1,collectFonts:j=!1,inlineImages:R=!1,plugins:d,keepIframeSrcFn:k=()=>!1,ignoreCSSAttributes:B=new Set([])}=F,u=!c||window.parent===window;let h=!1;if(!u)try{window.parent.document,h=!1}catch{h=!0}if(u&&!n)throw new Error("emit function is required");void 0!==l&&void 0===a.mousemove&&(a.mousemove=l),te.reset();const x=!0===W?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==e?e:{password:!0},O=!0===t||"all"===t?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===t,headMetaDescKeywords:"all"===t}:t||{};Te();let p,m=0;const f=e=>{for(const t of d||[])t.eventProcessor&&(e=t.eventProcessor(e));return e=s?s(e):e},y=(ee=(e,t)=>{var r;null==(r=Q[0])||!r.isFrozen()||e.type===K.FullSnapshot||e.type===K.IncrementalSnapshot&&e.data.source===J.Mutation||Q.forEach(e=>e.unfreeze()),u?n?.(f(e),t):h&&(r={type:"rrweb",event:f(e),isCheckout:t},window.parent.postMessage(r,"*")),e.type===K.FullSnapshot?(p=e,m=0):e.type!==K.IncrementalSnapshot||e.data.source===J.Mutation&&e.data.isAttachIframe||(m++,t=i&&m>=i,r=o&&e.timestamp-p.timestamp>o,(t||r)&&Qt(!0))},e=>{ee($({type:K.IncrementalSnapshot,data:q({source:J.Mutation},e)}))}),G=e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.Scroll},e)})),z=e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.CanvasMutation},e)})),L=new Bt({mutationCb:y,adoptedStyleSheetCb:e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.AdoptedStyleSheet},e)}))}),A=new dt({mirror:te,mutationCb:y,stylesheetManager:L,recordCrossOriginIframes:c,wrappedEmit:ee});for(const g of d||[])g.getMirror&&g.getMirror({nodeMirror:te,crossOriginIframeMirror:A.crossOriginIframeMirror,crossOriginIframeStyleMirror:A.crossOriginIframeStyleMirror});qt=new jt({recordCanvas:D,mutationCb:z,win:window,blockClass:w,blockSelector:E,mirror:te,sampling:a.canvas,dataURLOptions:M});const _=new bt({mutationCb:y,scrollCb:G,bypassOptions:{blockClass:w,blockSelector:E,maskTextClass:N,maskTextSelector:C,inlineStylesheet:I,maskInputOptions:x,dataURLOptions:M,maskTextFn:T,maskInputFn:r,recordCanvas:D,inlineImages:R,sampling:a,slimDOMOptions:O,iframeManager:A,stylesheetManager:L,canvasManager:qt,keepIframeSrcFn:k},mirror:te});Qt=(e=!1)=>{ee($({type:K.Meta,data:{href:window.location.href,width:we(),height:be()}}),e),L.reset(),Q.forEach(e=>e.lock()),e=document,t={mirror:te,blockClass:w,blockSelector:E,maskTextClass:N,maskTextSelector:C,inlineStylesheet:I,maskAllInputs:x,maskTextFn:T,slimDOM:O,dataURLOptions:M,recordCanvas:D,inlineImages:R,onSerialize:e=>{X(e,te)&&A.addIframe(e),Re(e,te)&&L.trackLinkElement(e),Z(e)&&_.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{A.attachIframe(e,t),_.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{L.attachLinkElement(e,t)},keepIframeSrcFn:k},r=void 0===(r=(t=t||{}).mirror)?new re:r,n=t.blockClass,o=t.blockSelector,i=t.maskTextClass,s=t.maskTextSelector,a=t.inlineStylesheet,l=t.inlineImages,c=t.recordCanvas,d=void 0!==(d=t.maskAllInputs)&&d,u=t.maskTextFn,h=t.maskInputFn,p=void 0!==(p=t.slimDOM)&&p,m=t.dataURLOptions,f=t.preserveWhiteSpace,y=t.onSerialize,g=t.onIframeLoad,v=t.iframeLoadTimeout,S=t.onStylesheetLoad,b=t.stylesheetLoadTimeout,t=t.keepIframeSrcFn;var t,r,n,o,i,s,a,l,c,d,u,h,p,m,f,y,g,v,S,b,e=H(e,{doc:e,mirror:r,blockClass:void 0===n?"rr-block":n,blockSelector:void 0===o?null:o,maskTextClass:void 0===i?"rr-mask":i,maskTextSelector:void 0===s?null:s,skipChild:!1,inlineStylesheet:void 0===a||a,maskInputOptions:!0===d?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===d?{password:!0}:d,maskTextFn:u,maskInputFn:h,slimDOMOptions:!0===p||"all"===p?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===p,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===p?{}:p,dataURLOptions:m,inlineImages:void 0!==l&&l,recordCanvas:void 0!==c&&c,preserveWhiteSpace:f,onSerialize:y,onIframeLoad:g,iframeLoadTimeout:v,onStylesheetLoad:S,stylesheetLoadTimeout:b,keepIframeSrcFn:void 0===t?function(){return!1}:t,newlyAddedElement:!1});if(!e)return console.warn("Failed to snapshot the document");ee($({type:K.FullSnapshot,data:{node:e,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:document?.documentElement.scrollLeft||(null==(n=null==(r=document?.body)?void 0:r.parentElement)?void 0:n.scrollLeft)||(null==(o=document?.body)?void 0:o.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:document?.documentElement.scrollTop||(null==(s=null==(i=document?.body)?void 0:i.parentElement)?void 0:s.scrollTop)||(null==(a=document?.body)?void 0:a.scrollTop)||0}}})),Q.forEach(e=>e.unlock()),document.adoptedStyleSheets&&0<document.adoptedStyleSheets.length&&L.adoptStyleSheets(document.adoptedStyleSheets,te.getId(document))};try{const v=[],S=(v.push(Y("DOMContentLoaded",()=>{ee($({type:K.DomContentLoaded,data:{}}))})),e=>{return lt({mutationCb:y,mousemoveCb:(e,t)=>ee($({type:K.IncrementalSnapshot,data:{source:t,positions:e}})),mouseInteractionCb:e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.MouseInteraction},e)})),scrollCb:G,viewportResizeCb:e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.ViewportResize},e)})),inputCb:e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.Input},e)})),mediaInteractionCb:e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.MediaInteraction},e)})),styleSheetRuleCb:e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.StyleSheetRule},e)})),styleDeclarationCb:e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.StyleDeclaration},e)})),canvasMutationCb:z,fontCb:e=>ee($({type:K.IncrementalSnapshot,data:q({source:J.Font},e)})),selectionCb:e=>{ee($({type:K.IncrementalSnapshot,data:q({source:J.Selection},e)}))},blockClass:w,ignoreClass:P,maskTextClass:N,maskTextSelector:C,maskInputOptions:x,inlineStylesheet:I,sampling:a,recordCanvas:D,inlineImages:R,userTriggeredOnInput:V,collectFonts:j,doc:e,maskInputFn:r,maskTextFn:T,keepIframeSrcFn:k,blockSelector:E,slimDOMOptions:O,dataURLOptions:M,mirror:te,iframeManager:A,stylesheetManager:L,shadowDomManager:_,canvasManager:qt,ignoreCSSAttributes:B,plugins:(null==(e=d?.filter(e=>e.observer))?void 0:e.map(t=>({observer:t.observer,options:t.options,callback:e=>ee($({type:K.Plugin,data:{plugin:t.name,payload:e}}))})))||[]},U)}),b=(A.addLoadListener(e=>{v.push(S(e.contentDocument))}),()=>{Qt(),v.push(S(document)),$t=!0});return"interactive"===document.readyState||"complete"===document.readyState?b():v.push(Y("load",()=>{ee($({type:K.Load,data:{}})),b()},window)),()=>{v.forEach(e=>e()),$t=!1}}catch(e){console.warn(e)}}o.addCustomEvent=(e,t)=>{if(!$t)throw new Error("please add custom event after start recording");ee($({type:K.Custom,data:{tag:e,payload:t}}))},o.freezePage=()=>{Q.forEach(e=>e.freeze())},o.takeFullSnapshot=e=>{if(!$t)throw new Error("please take full snapshot after start recording");Qt(e)},o.mirror=te,(l=N=N||{})[l.Document=0]="Document",l[l.DocumentType=1]="DocumentType",l[l.Element=2]="Element",l[l.Text=3]="Text",l[l.CDATA=4]="CDATA",l[l.Comment=5]="Comment";i.prototype.getId=function(e){return e?(null==(e=this.getMeta(e))?void 0:e.id)??-1:-1},i.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},i.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},i.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},i.prototype.removeNodeFromMap=function(e){var t=this,r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach(function(e){return t.removeNodeFromMap(e)})},i.prototype.has=function(e){return this.idNodeMap.has(e)},i.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},i.prototype.add=function(e,t){var r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)},i.prototype.replace=function(e,t){var r=this.getNode(e);r&&(r=this.nodeMetaMap.get(r))&&this.nodeMetaMap.set(t,r),this.idNodeMap.set(e,t)},i.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap};var u,er=i;function i(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}function tr(e){var t=[];for(const o in e){var r,n=e[o];"string"==typeof n&&(r=sr(o),t.push(r+`: ${n};`))}return t.join(" ")}const rr=/-([a-z])/g,nr=/^--[a-zA-Z0-9-]+$/,or=e=>nr.test(e)?e:e.replace(rr,(e,t)=>t?t.toUpperCase():""),ir=/\B([A-Z])/g,sr=e=>e.replace(ir,"-$1").toLowerCase();class a{constructor(){this.childNodes=[],this.parentElement=null,this.parentNode=null,this.ELEMENT_NODE=u.ELEMENT_NODE,this.TEXT_NODE=u.TEXT_NODE}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get nextSibling(){var e,t=this.parentNode;return t&&(e=(t=t.childNodes).indexOf(this),t[e+1])||null}contains(e){if(e===this)return!0;for(const t of this.childNodes)if(t.contains(e))return!0;return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,t){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function ar(e){return class extends e{constructor(e,t,r){super(),this.nodeType=u.DOCUMENT_TYPE_NODE,this.RRNodeType=N.DocumentType,this.textContent=null,this.name=e,this.publicId=t,this.systemId=r,this.nodeName=e}toString(){return"RRDocumentType"}}}function lr(e){return class extends e{constructor(e){super(),this.nodeType=u.ELEMENT_NODE,this.RRNodeType=N.Element,this.attributes={},this.shadowRoot=null,this.tagName=e.toUpperCase(),this.nodeName=e.toUpperCase()}get textContent(){let t="";return this.childNodes.forEach(e=>t+=e.textContent),t}set textContent(e){this.childNodes=[this.ownerDocument.createTextNode(e)]}get classList(){return new hr(this.attributes.class,e=>{this.attributes.class=e})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const n=this.attributes.style?function(e){const t={},r=/:(.+)/;return e.replace(/\/\*.*?\*\//g,"").split(/;(?![^(]*\))/g).forEach(function(e){e&&1<(e=e.split(r)).length&&(t[or(e[0].trim())]=e[1].trim())}),t}(this.attributes.style):{},o=/\B([A-Z])/g;return n.setProperty=(e,t,r)=>{o.test(e)||(e=or(e),t?n[e]=t:delete n[e],"important"===r&&(n[e]+=" !important"),this.attributes.style=tr(n))},n.removeProperty=e=>{var t;return o.test(e)?"":(e=or(e),t=n[e]||"",delete n[e],this.attributes.style=tr(n),t)},n}getAttribute(e){return this.attributes[e]||null}setAttribute(e,t){this.attributes[e]=t}setAttributeNS(e,t,r){this.setAttribute(t,r)}removeAttribute(e){delete this.attributes[e]}appendChild(e){return this.childNodes.push(e),e.parentNode=this,e.parentElement=this,e}insertBefore(e,t){if(null===t)return this.appendChild(e);t=this.childNodes.indexOf(t);if(-1==t)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(t,0,e),e.parentElement=this,e.parentNode=this,e}removeChild(e){var t=this.childNodes.indexOf(e);if(-1===t)throw new Error("Failed to execute 'removeChild' on 'RRElement': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(t,1),e.parentElement=null,e.parentNode=null,e}attachShadow(e){var t=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=t}dispatchEvent(e){return!0}toString(){let e="";for(const t in this.attributes)e+=`${t}="${this.attributes[t]}" `;return this.tagName+" "+e}}}function cr(e){return class extends e{constructor(e){super(),this.nodeType=u.TEXT_NODE,this.nodeName="#text",this.RRNodeType=N.Text,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return"RRText text="+JSON.stringify(this.data)}}}function dr(e){return class extends e{constructor(e){super(),this.nodeType=u.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=N.Comment,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return"RRComment text="+JSON.stringify(this.data)}}}function ur(e){return class extends e{constructor(e){super(),this.nodeName="#cdata-section",this.nodeType=u.CDATA_SECTION_NODE,this.RRNodeType=N.CDATA,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return"RRCDATASection data="+JSON.stringify(this.data)}}}class hr{constructor(e,t){this.classes=[],this.add=(...e)=>{for(const r of e){var t=String(r);0<=this.classes.indexOf(t)||this.classes.push(t)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...t)=>{this.classes=this.classes.filter(e=>-1===t.indexOf(e)),this.onChange&&this.onChange(this.classes.join(" "))},e&&(e=e.trim().split(/\s+/),this.classes.push(...e)),this.onChange=t}}(l=u=u||{})[l.PLACEHOLDER=0]="PLACEHOLDER",l[l.ELEMENT_NODE=1]="ELEMENT_NODE",l[l.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",l[l.TEXT_NODE=3]="TEXT_NODE",l[l.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",l[l.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",l[l.ENTITY_NODE=6]="ENTITY_NODE",l[l.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",l[l.COMMENT_NODE=8]="COMMENT_NODE",l[l.DOCUMENT_NODE=9]="DOCUMENT_NODE",l[l.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",l[l.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE";const pr={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},mr={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function I(t,e,r,n){var o,i,s,a=t.childNodes,l=e.childNodes;n=n||e.mirror||e.ownerDocument.mirror,(0<a.length||0<l.length)&&fr(Array.from(a),l,t,r,n);let c=null,d=null;switch(e.RRNodeType){case N.Document:d=e.scrollData;break;case N.Element:{const p=t,m=e;switch(function(t,e,r){var n=t.attributes,o=e.attributes;for(const l in o){var i=o[l],s=r.getMeta(e);if(s&&"isSVG"in s&&s.isSVG&&pr[l])t.setAttributeNS(pr[l],l,i);else if("CANVAS"===e.tagName&&"rr_dataURL"===l){const c=document.createElement("img");c.src=i,c.onload=()=>{var e=t.getContext("2d");e&&e.drawImage(c,0,0,c.width,c.height)}}else t.setAttribute(l,i)}for(var{name:a}of Array.from(n))a in o||t.removeAttribute(a);e.scrollLeft&&(t.scrollLeft=e.scrollLeft),e.scrollTop&&(t.scrollTop=e.scrollTop)}(p,m,n),d=m.scrollData,c=m.inputData,m.tagName){case"AUDIO":case"VIDEO":var u=t,h=m;void 0!==h.paused&&(h.paused?u.pause():u.play()),void 0!==h.muted&&(u.muted=h.muted),void 0!==h.volume&&(u.volume=h.volume),void 0!==h.currentTime&&(u.currentTime=h.currentTime),void 0!==h.playbackRate&&(u.playbackRate=h.playbackRate);break;case"CANVAS":u=e;if(null!==u.rr_dataURL){const f=document.createElement("img");f.onload=()=>{var e=p.getContext("2d");e&&e.drawImage(f,0,0,f.width,f.height)},f.src=u.rr_dataURL}u.canvasMutations.forEach(e=>r.applyCanvas(e.event,e.mutation,t));break;case"STYLE":{const y=p.sheet;y&&e.rules.forEach(e=>r.applyStyleSheetMutation(e,y))}}m.shadowRoot&&(p.shadowRoot||p.attachShadow({mode:"open"}),o=p.shadowRoot.childNodes,i=m.shadowRoot.childNodes,0<o.length||0<i.length)&&fr(Array.from(o),i,p.shadowRoot,r,n);break}case N.Text:case N.Comment:case N.CDATA:t.textContent!==e.data&&(t.textContent=e.data)}d&&r.applyScroll(d,!0),c&&r.applyInput(c),"IFRAME"===e.nodeName&&(a=e,l=t.contentDocument)&&((s=n.getMeta(a.contentDocument))&&r.mirror.add(l,Object.assign({},s)),I(l,a.contentDocument,r,n))}function fr(t,e,r,n,o){let i=0,s=t.length-1,a=0,l=e.length-1,c=t[i],d=t[s],u=e[a],h=e[l],p,m;for(;i<=s&&a<=l;){var f=n.mirror.getId(c),y=n.mirror.getId(d),g=o.getId(u),v=o.getId(h);if(void 0===c)c=t[++i];else if(void 0===d)d=t[--s];else if(-1!==f&&f===g)I(c,u,n,o),c=t[++i],u=e[++a];else if(-1!==y&&y===v)I(d,h,n,o),d=t[--s],h=e[--l];else if(-1!==f&&f===v)r.insertBefore(c,d.nextSibling),I(c,h,n,o),c=t[++i],h=e[--l];else{if(-1!==y&&y===g)r.insertBefore(d,c),I(d,u,n,o),d=t[--s];else{if(!p){p={};for(let e=i;e<=s;e++){var S=t[e];S&&n.mirror.hasNode(S)&&(p[n.mirror.getId(S)]=e)}}(m=p[o.getId(u)])?(f=t[m],r.insertBefore(f,c),I(f,u,n,o),t[m]=void 0):(v=yr(u,n.mirror,o),"#document"===r.nodeName&&(null==(y=n.mirror.getMeta(v))?void 0:y.type)===N.Element&&r.documentElement&&(r.removeChild(r.documentElement),t[i]=void 0,c=void 0),r.insertBefore(v,c||null),I(v,u,n,o))}u=e[++a]}}if(i>s){const E=e[l+1];let t=null;for(E&&r.childNodes.forEach(e=>{n.mirror.getId(e)===o.getId(E)&&(t=e)});a<=l;++a){var b=yr(e[a],n.mirror,o);r.insertBefore(b,t),I(b,e[a],n,o)}}else if(a>l)for(;i<=s;i++){var w=t[i];w&&(r.removeChild(w),n.mirror.removeNodeFromMap(w))}}function yr(e,t,r){var n=r.getId(e),o=r.getMeta(e);let i=null;if(null===(i=-1<n?t.getNode(n):i)){switch(e.RRNodeType){case N.Document:i=new Document;break;case N.DocumentType:i=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case N.Element:var s=e.tagName.toLowerCase(),s=mr[s]||s;i=o&&"isSVG"in o&&o?.isSVG?document.createElementNS(pr.svg,s):document.createElement(e.tagName);break;case N.Text:i=document.createTextNode(e.data);break;case N.Comment:i=document.createComment(e.data);break;case N.CDATA:i=document.createCDATASection(e.data)}o&&t.add(i,Object.assign({},o))}return i}class gr extends(l=a,class Dn extends l{constructor(){super(...arguments),this.nodeType=u.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=N.Document,this.textContent=null}get documentElement(){return this.childNodes.find(e=>e.RRNodeType===N.Element&&"HTML"===e.tagName)||null}get body(){var e;return(null==(e=this.documentElement)?void 0:e.childNodes.find(e=>e.RRNodeType===N.Element&&"BODY"===e.tagName))||null}get head(){var e;return(null==(e=this.documentElement)?void 0:e.childNodes.find(e=>e.RRNodeType===N.Element&&"HEAD"===e.tagName))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(e){const t=e.RRNodeType;if(t!==N.Element&&t!==N.DocumentType||!this.childNodes.some(e=>e.RRNodeType===t))return e.parentElement=null,(e.parentNode=this).childNodes.push(e),e;throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${t===N.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`)}insertBefore(e,t){const r=e.RRNodeType;if((r===N.Element||r===N.DocumentType)&&this.childNodes.some(e=>e.RRNodeType===r))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${r===N.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);if(null===t)return this.appendChild(e);t=this.childNodes.indexOf(t);if(-1==t)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(t,0,e),e.parentElement=null,e.parentNode=this,e}removeChild(e){var t=this.childNodes.indexOf(e);if(-1===t)throw new Error("Failed to execute 'removeChild' on 'RRDocument': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(t,1),e.parentElement=null,e.parentNode=null,e}open(){this.childNodes=[]}close(){}write(e){let t;'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'===e?t="-//W3C//DTD XHTML 1.0 Transitional//EN":'<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'===e&&(t="-//W3C//DTD HTML 4.0 Transitional//EN"),t&&(e=this.createDocumentType("html",t,""),this.open(),this.appendChild(e))}createDocument(e,t,r){return new Dn}createDocumentType(e,t,r){e=new(ar(a))(e,t,r);return e.ownerDocument=this,e}createElement(e){e=new(lr(a))(e);return e.ownerDocument=this,e}createElementNS(e,t){return this.createElement(t)}createTextNode(e){e=new(cr(a))(e);return e.ownerDocument=this,e}createComment(e){e=new(dr(a))(e);return e.ownerDocument=this,e}createCDATASection(e){e=new(ur(a))(e);return e.ownerDocument=this,e}toString(){return"RRDocument"}}){constructor(e){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=new Rr,this.scrollData=null,e&&(this.mirror=e)}get unserializedId(){return this._unserializedId--}createDocument(e,t,r){return new gr}createDocumentType(e,t,r){e=new vr(e,t,r);return e.ownerDocument=this,e}createElement(e){var t=e.toUpperCase();let r;switch(t){case"AUDIO":case"VIDEO":r=new br(t);break;case"IFRAME":r=new Nr(t,this.mirror);break;case"CANVAS":r=new wr(t);break;case"STYLE":r=new Er(t);break;default:r=new Sr(t)}return r.ownerDocument=this,r}createComment(e){e=new Ir(e);return e.ownerDocument=this,e}createCDATASection(e){e=new Tr(e);return e.ownerDocument=this,e}createTextNode(e){e=new Cr(e);return e.ownerDocument=this,e}destroyTree(){this.childNodes=[],this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const vr=ar(a);class Sr extends lr(a){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class br extends(l=Sr,class extends l{attachShadow(e){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}){}class wr extends Sr{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class Er extends Sr{constructor(){super(...arguments),this.rules=[]}}class Nr extends Sr{constructor(e,t){super(e),this.contentDocument=new gr,this.contentDocument.mirror=t}}const Cr=cr(a),Ir=dr(a),Tr=ur(a);function Mr(e,t,r,n){let o;switch(e.nodeType){case u.DOCUMENT_NODE:n&&"IFRAME"===n.nodeName?o=n.contentDocument:(o=t).compatMode=e.compatMode;break;case u.DOCUMENT_TYPE_NODE:o=t.createDocumentType(e.name,e.publicId,e.systemId);break;case u.ELEMENT_NODE:var i,s,a=e,l=(l=a)instanceof HTMLFormElement?"FORM":l.tagName.toUpperCase(),c=o=t.createElement(l);for({name:i,value:s}of Array.from(a.attributes))c.attributes[i]=s;a.scrollLeft&&(c.scrollLeft=a.scrollLeft),a.scrollTop&&(c.scrollTop=a.scrollTop);break;case u.TEXT_NODE:o=t.createTextNode(e.textContent||"");break;case u.CDATA_SECTION_NODE:o=t.createCDATASection(e.data);break;case u.COMMENT_NODE:o=t.createComment(e.textContent||"");break;case u.DOCUMENT_FRAGMENT_NODE:o=n.attachShadow({mode:"open"});break;default:return null}var l;let d=r.getMeta(e);return t instanceof gr&&(d||(d=kr(o,t.unserializedId),r.add(e,d)),t.mirror.add(o,Object.assign({},d))),o}function Dr(e,o=new er,i=new gr){!function t(e,r){const n=Mr(e,i,o,r);null!==n&&("IFRAME"!==r?.nodeName&&e.nodeType!==u.DOCUMENT_FRAGMENT_NODE&&(r?.appendChild(n),n.parentNode=r,n.parentElement=r),"IFRAME"===e.nodeName?(r=e.contentDocument)&&t(r,n):e.nodeType!==u.DOCUMENT_NODE&&e.nodeType!==u.ELEMENT_NODE&&e.nodeType!==u.DOCUMENT_FRAGMENT_NODE||(e.nodeType===u.ELEMENT_NODE&&e.shadowRoot&&t(e.shadowRoot,n),e.childNodes.forEach(e=>t(e,n))))}(e,null)}class Rr{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){return e?(null==(e=this.getMeta(e))?void 0:e.id)??-1:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){var t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(e=>this.removeNodeFromMap(e))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){var r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)}replace(e,t){var r=this.getNode(e);r&&(r=this.nodeMetaMap.get(r))&&this.nodeMetaMap.set(t,r),this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function kr(e,t){switch(e.RRNodeType){case N.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case N.DocumentType:return{id:t,type:e.RRNodeType,name:e.name,publicId:e.publicId,systemId:e.systemId};case N.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case N.Text:case N.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case N.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}function xr(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(t,r){var e=n.get(t);e&&e.slice().map(function(e){e(r)}),(e=n.get("*"))&&e.slice().map(function(e){e(t,r)})}}}var Or;Object.freeze({__proto__:null,default:xr});function Lr(l=window,c=document){if(!("scrollBehavior"in c.documentElement.style&&!0!==l.__forceSmoothScrollPolyfill__)){const t=l.HTMLElement||l.Element,h=468,p={scroll:l.scroll||l.scrollTo,scrollBy:l.scrollBy,elementScroll:t.prototype.scroll||d,scrollIntoView:t.prototype.scrollIntoView},m=l.performance&&l.performance.now?l.performance.now.bind(l.performance):Date.now,r=(e=l.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(e)?1:0);var e;function d(e,t){this.scrollLeft=e,this.scrollTop=t}function n(e){if(null===e||"object"!=typeof e||void 0===e.behavior||"auto"===e.behavior||"instant"===e.behavior)return!0;if("object"==typeof e&&"smooth"===e.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+e.behavior+" is not a valid value for enumeration ScrollBehavior.")}function o(e,t){return"Y"===t?e.clientHeight+r<e.scrollHeight:"X"===t?e.clientWidth+r<e.scrollWidth:void 0}function i(e,t){e=l.getComputedStyle(e,null)["overflow"+t];return"auto"===e||"scroll"===e}function s(e){for(;e!==c.body&&!1===(r=void 0,r=o(t=e,"Y")&&i(t,"Y"),t=o(t,"X")&&i(t,"X"),r||t);)e=e.parentNode||e.host;var t,r;return e}function u(e){var t=m(),t=1<(t=(t-e.startTime)/h)?1:t,t=.5*(1-Math.cos(Math.PI*t)),r=e.startX+(e.x-e.startX)*t,t=e.startY+(e.y-e.startY)*t;e.method.call(e.scrollable,r,t),r===e.x&&t===e.y||l.requestAnimationFrame(u.bind(l,e))}function a(e,t,r){let n,o,i,s;var a=m();s=e===c.body?(n=l,o=l.scrollX||l.pageXOffset,i=l.scrollY||l.pageYOffset,p.scroll):(n=e,o=e.scrollLeft,i=e.scrollTop,d),u({scrollable:n,method:s,startTime:a,startX:o,startY:i,x:t,y:r})}l.scroll=l.scrollTo=function(){void 0!==arguments[0]&&(!0===n(arguments[0])?p.scroll.call(l,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:l.scrollX||l.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:l.scrollY||l.pageYOffset):a.call(l,c.body,void 0!==arguments[0].left?~~arguments[0].left:l.scrollX||l.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:l.scrollY||l.pageYOffset))},l.scrollBy=function(){void 0!==arguments[0]&&(n(arguments[0])?p.scrollBy.call(l,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0):a.call(l,c.body,~~arguments[0].left+(l.scrollX||l.pageXOffset),~~arguments[0].top+(l.scrollY||l.pageYOffset)))},t.prototype.scroll=t.prototype.scrollTo=function(){if(void 0!==arguments[0])if(!0===n(arguments[0])){if("number"==typeof arguments[0]&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");p.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!=typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}else{var e=arguments[0].left,t=arguments[0].top;a.call(this,this,"u"<typeof e?this.scrollLeft:~~e,"u"<typeof t?this.scrollTop:~~t)}},t.prototype.scrollBy=function(){void 0!==arguments[0]&&(!0===n(arguments[0])?p.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop):this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}))},t.prototype.scrollIntoView=function(){var e,t,r;!0===n(arguments[0])?p.scrollIntoView.call(this,void 0===arguments[0]||arguments[0]):(t=(e=s(this)).getBoundingClientRect(),r=this.getBoundingClientRect(),e!==c.body?(a.call(this,e,e.scrollLeft+r.left-t.left,e.scrollTop+r.top-t.top),"fixed"!==l.getComputedStyle(e).position&&l.scrollBy({left:t.left,top:t.top,behavior:"smooth"})):l.scrollBy({left:r.left,top:r.top,behavior:"smooth"}))}}}class Ar{constructor(e=[],t){this.timeOffset=0,this.raf=null,this.actions=e,this.speed=t.speed,this.liveMode=t.liveMode}addAction(e){var t;!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay?this.actions.push(e):(t=this.findActionIndex(e),this.actions.splice(t,0,e))}start(){this.timeOffset=0;let r=performance.now();const n=()=>{var e=performance.now();for(this.timeOffset+=(e-r)*this.speed,r=e;this.actions.length;){var t=this.actions[0];if(!(this.timeOffset>=t.delay))break;this.actions.shift(),t.doAction()}(0<this.actions.length||this.liveMode)&&(this.raf=requestAnimationFrame(n))};this.raf=requestAnimationFrame(n)}clear(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}toggleLiveMode(e){this.liveMode=e}isActive(){return null!==this.raf}findActionIndex(e){let t=0,r=this.actions.length-1;for(;t<=r;){var n=Math.floor((t+r)/2);if(this.actions[n].delay<e.delay)t=n+1;else{if(!(this.actions[n].delay>e.delay))return n+1;r=n-1}}return t}}function _r(e,t){var r;if(e.type===K.IncrementalSnapshot&&e.data.source===J.MouseMove&&e.data.positions&&e.data.positions.length)return r=e.data.positions[0].timeOffset,r=e.timestamp+r,e.delay=r-t;e.delay=e.timestamp-t,e.delay}function Fr(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}(l=Or=Or||{})[l.NotStarted=0]="NotStarted",l[l.Running=1]="Running",l[l.Stopped=2]="Stopped";var Pr={type:"xstate.init"};function Wr(e){return void 0===e?[]:[].concat(e)}function Ur(e){return{type:"xstate.assign",assignment:e}}function Vr(e,t){return"string"==typeof(e="string"==typeof e&&t&&t[e]?t[e]:e)?{type:e}:"function"==typeof e?{type:e.name,exec:e}:e}function jr(t){return function(e){return t===e}}function Br(e){return"string"==typeof e?{type:e}:e}function Gr(e,t){return{value:e,context:t,actions:[],changed:!1,matches:jr(e)}}function zr(e,t,n){var o=t,i=!1;return[e.filter(function(t){var r;return"xstate.assign"!==t.type||(i=!0,r=Object.assign({},o),"function"==typeof t.assignment?r=t.assignment(o,n):Object.keys(t.assignment).forEach(function(e){r[e]="function"==typeof t.assignment[e]?t.assignment[e](o,n):t.assignment[e]}),o=r,!1)}),o,i]}function Hr(I,t){void 0===t&&(t={});var e=Fr(zr(Wr(I.states[I.initial].entry).map(function(e){return Vr(e,t.actions)}),I.context,Pr),2),r=e[0],e=e[1],T={config:I,_options:t,initialState:{value:I.initial,actions:r,context:e,matches:jr(I.initial)},transition:function(e,t){var r,n,e="string"==typeof e?{value:e,context:I.context}:e,o=e.value,i=e.context,s=Br(t),a=I.states[o];if(a.on){e=Wr(a.on[s.type]);try{for(var l=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),c=l.next();!c.done;c=l.next()){var d=c.value;if(void 0===d)return Gr(o,i);var u,h,p,m,f,y="string"==typeof d?{target:d}:d,g=y.target,v=y.actions,S=void 0===v?[]:v,b=y.cond,w=void 0===b?function(){return!0}:b,E=void 0===g,N=g??o,C=I.states[N];if(w(i,s))return h=(u=Fr(zr((E?Wr(S):[].concat(a.exit,S,C.entry).filter(function(e){return e})).map(function(e){return Vr(e,T._options.actions)}),i,s),3))[0],p=u[1],m=u[2],{value:f=g??o,context:p,actions:h,changed:g!==o||0<h.length||m,matches:jr(f)}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}return Gr(o,i)}};return T}var Yr=function(t,r){return t.actions.forEach(function(e){e=e.exec;return e&&e(t.context,r)})};function Xr(t){var r=t.initialState,n=Or.NotStarted,o=new Set,i={_machine:t,send:function(e){n===Or.Running&&(r=t.transition(r,e),Yr(r,Br(e)),o.forEach(function(e){return e(r)}))},subscribe:function(e){return o.add(e),e(r),{unsubscribe:function(){return o.delete(e)}}},start:function(e){return e&&(e="object"==typeof e?e:{context:t.config.context,value:e},r={value:e.value,actions:[],context:e.context,matches:jr(e.value)}),n=Or.Running,Yr(r,Pr),i},stop:function(){return n=Or.Stopped,o.clear(),i},get state(){return r},get status(){return n}};return i}var Zr=Object.defineProperty,Kr=Object.defineProperties,Jr=Object.getOwnPropertyDescriptors,Qr=Object.getOwnPropertySymbols,qr=Object.prototype.hasOwnProperty,$r=Object.prototype.propertyIsEnumerable,en=(e,t,r)=>t in e?Zr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,tn=(e,t)=>{for(var r in t=t||{})qr.call(t,r)&&en(e,r,t[r]);if(Qr)for(var r of Qr(t))$r.call(t,r)&&en(e,r,t[r]);return e},rn=(e,t)=>Kr(e,Jr(t));function nn(e,{getCastFn:d,applyEventsSynchronously:u,emitter:h}){return Xr(Hr({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:Ur({lastPlayedEvent:(e,t)=>"CAST_EVENT"===t.type?t.payload.event:e.lastPlayedEvent}),recordTimeOffset:Ur((e,t)=>{let r=e.timeOffset;return"payload"in t&&"timeOffset"in t.payload&&(r=t.payload.timeOffset),rn(tn({},e),{timeOffset:r,baselineTime:e.events[0].timestamp+r})}),play(e){var t,{timer:r,events:e,baselineTime:n,lastPlayedEvent:o}=e;r.clear();for(const a of e)_r(a,n);e=function(t,r){for(let e=t.length-1;0<=e;e--){var n=t[e];if(n.type===K.Meta&&n.timestamp<=r)return t.slice(e)}return t}(e,n);let i=o?.timestamp;n<((i=o?.type===K.IncrementalSnapshot&&o.data.source===J.MouseMove?o.timestamp+(null==(t=o.data.positions[0])?void 0:t.timeOffset):i)||0)&&h.emit(m.PlayBack);var s=new Array;for(const l of e)if(!(i&&i<n&&(l.timestamp<=i||l===o)))if(l.timestamp<n)s.push(l);else{const c=d(l,!1);r.addAction({doAction:()=>{c()},delay:l.delay})}u(s),h.emit(m.Flush),r.start()},pause(e){e.timer.clear()},resetLastPlayedEvent:Ur(e=>rn(tn({},e),{lastPlayedEvent:null})),startLive:Ur({baselineTime:(e,t)=>(e.timer.toggleLiveMode(!0),e.timer.start(),"TO_LIVE"===t.type&&t.payload.baselineTime?t.payload.baselineTime:Date.now())}),addEvent:Ur((e,t)=>{var{baselineTime:n,timer:o,events:i}=e;if("ADD_EVENT"===t.type){var s=t.payload["event"];_r(s,n);let r=i.length-1;if(!i[r]||i[r].timestamp<=s.timestamp)i.push(s);else{let e=-1,t=0;for(;t<=r;){var a=Math.floor((t+r)/2);i[a].timestamp<=s.timestamp?t=a+1:r=a-1}-1===e&&(e=t),i.splice(e,0,s)}const l=s.timestamp<n,c=d(s,l);l?c():o.isActive()&&o.addAction({doAction:()=>{c()},delay:s.delay})}return rn(tn({},e),{events:i})})}}))}var on=(e,s,a)=>new Promise((t,r)=>{var n=e=>{try{i(a.next(e))}catch(e){r(e)}},o=e=>{try{i(a.throw(e))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);i((a=a.apply(e,s)).next())});const sn=new Map;function an(e,t){let r=sn.get(e);return r||(r=new Map,sn.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}function h(n,o,i){return r=>on(this,null,function*(){if(r&&"object"==typeof r&&"rr_type"in r){var e,t;if(i&&(i.isUnchanged=!1),"ImageBitmap"===r.rr_type&&"args"in r)return e=yield h(n,o,i)(r.args),yield createImageBitmap.apply(null,e);if("index"in r)return i||null===o?r:({rr_type:e,index:t}=r,an(o,e)[t]);if("args"in r)return{rr_type:e,args:t}=r,new window[e](...yield Promise.all(t.map(h(n,o,i))));if("base64"in r)return It(r.base64);if("src"in r)return n.get(r.src)||((e=new Image).src=r.src,n.set(r.src,e),e);if("data"in r&&"Blob"===r.rr_type)return t=yield Promise.all(r.data.map(h(n,o,i))),new Blob(t,{type:r.type})}else if(Array.isArray(r))return yield Promise.all(r.map(h(n,o,i)));return r})}var ln=(e,s,a)=>new Promise((t,r)=>{var n=e=>{try{i(a.next(e))}catch(e){r(e)}},o=e=>{try{i(a.throw(e))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);i((a=a.apply(e,s)).next())});const cn=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function dn(){return ln(this,arguments,function*({mutation:t,target:e,type:r,imageMap:n,errorHandler:o}){try{var i,s,a,l=function(e,t){try{return t===p.WebGL?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}catch{return null}}(e,r);l&&(t.setter?l[t.property]=t.args[0]:(i=l[t.property],s=yield Promise.all(t.args.map(h(n,l))),a=i.apply(l,s),c=l,null!=(d=a)&&d.constructor&&(u=d.constructor.name,cn.includes(u))&&!(c=an(c,u)).includes(d)&&c.push(d)))}catch(e){o(t,e)}var c,d,u})}var un=(e,s,a)=>new Promise((t,r)=>{var n=e=>{try{i(a.next(e))}catch(e){r(e)}},o=e=>{try{i(a.throw(e))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);i((a=a.apply(e,s)).next())});function hn(){var e,s,a;e=this,s=arguments,a=function*({event:t,mutation:r,target:n,imageMap:o,canvasEventMap:e,errorHandler:i}){try{var s=e.get(t)||r,a="commands"in s?s.commands:[s];if([p.WebGL,p.WebGL2].includes(r.type))for(let e=0;e<a.length;e++)yield dn({mutation:a[e],type:r.type,target:n,imageMap:o,errorHandler:i});else for(let e=0;e<a.length;e++)yield function(){return un(this,arguments,function*({event:e,mutation:t,target:r,imageMap:n,errorHandler:o}){try{var i,s,a=r.getContext("2d");t.setter?a[t.property]=t.args[0]:(i=a[t.property],"drawImage"===t.property&&"string"==typeof t.args[0]?(n.get(e),i.apply(a,t.args)):(s=yield Promise.all(t.args.map(h(n,a))),i.apply(a,s)))}catch(e){o(t,e)}})}({event:t,mutation:a[e],target:n,imageMap:o,errorHandler:i})}catch(e){i(r,e)}},new Promise((t,r)=>{var n=e=>{try{i(a.next(e))}catch(e){r(e)}},o=e=>{try{i(a.throw(e))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);i((a=a.apply(e,s)).next())})}var pn=Object.defineProperty,mn=Object.defineProperties,fn=Object.getOwnPropertyDescriptors,yn=Object.getOwnPropertySymbols,gn=Object.prototype.hasOwnProperty,vn=Object.prototype.propertyIsEnumerable,Sn=(e,t,r)=>t in e?pn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bn=(e,t)=>{for(var r in t=t||{})gn.call(t,r)&&Sn(e,r,t[r]);if(yn)for(var r of yn(t))vn.call(t,r)&&Sn(e,r,t[r]);return e},wn=(e,t)=>mn(e,fn(t)),En=(e,s,a)=>new Promise((t,r)=>{var n=e=>{try{i(a.next(e))}catch(e){r(e)}},o=e=>{try{i(a.throw(e))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);i((a=a.apply(e,s)).next())});const Nn=xr,Cn="[replayer]",In={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Tn(e){return e.type==K.IncrementalSnapshot&&(e.data.source==J.TouchMove||e.data.source==J.MouseInteraction&&e.data.type==c.TouchStart)}var l=o["addCustomEvent"],Mn=o["freezePage"];return e.EventType=K,e.IncrementalSource=J,e.MouseInteractions=c,e.Replayer=class{constructor(e,t){if(this.usingVirtualDom=!1,this.virtualDom=new gr,this.mouseTail=null,this.tailPositions=[],this.emitter=Nn(),this.legacy_missingNodeRetryMap={},this.cache=me(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=f(),this.styleMirror=new Le,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=e=>{this.iframe.style.display="inherit";for(const t of[this.mouseTail,this.iframe])t&&(t.setAttribute("width",String(e.width)),t.setAttribute("height",String(e.height)))},this.applyEventsSynchronously=e=>{for(const t of e){switch(t.type){case K.DomContentLoaded:case K.Load:case K.Custom:continue;case K.FullSnapshot:case K.Meta:case K.Plugin:case K.IncrementalSnapshot:}this.getCastFn(t,!0)()}!0===this.touchActive?this.mouse.classList.add("touch-active"):!1===this.touchActive&&this.mouse.classList.remove("touch-active"),this.touchActive=null},this.getCastFn=(n,o=!1)=>{let i;switch(n.type){case K.DomContentLoaded:case K.Load:break;case K.Custom:i=()=>{this.emitter.emit(m.CustomEvent,n)};break;case K.Meta:i=()=>this.emitter.emit(m.Resize,{width:n.data.width,height:n.data.height});break;case K.FullSnapshot:i=()=>{var e;if(this.firstFullSnapshot){if(this.firstFullSnapshot===n)return void(this.firstFullSnapshot=!0)}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(n,o),null!=(e=this.iframe.contentWindow)&&e.scrollTo(n.data.initialOffset),this.styleMirror.reset()};break;case K.IncrementalSnapshot:i=()=>{if(this.applyIncremental(n,o),!o&&(n===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive)&&!this.nextUserInteractionEvent){for(const t of this.service.state.context.events)if(!(t.timestamp<=n.timestamp)&&this.isUserInteraction(t)){t.delay-n.delay>1e4*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=t);break}var e;this.nextUserInteractionEvent&&(e=this.nextUserInteractionEvent.delay-n.delay,e={speed:Math.min(Math.round(e/5e3),this.config.maxSpeed)},this.speedService.send({type:"FAST_FORWARD",payload:e}),this.emitter.emit(m.SkipStart,e))}}}return()=>{i&&i();for(const t of this.config.plugins||[])t.handler&&t.handler(n,o,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:n}});const e=this.service.state.context.events.length-1;if(n===this.service.state.context.events[e]){const r=()=>{e<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(m.Finish))};n.type===K.IncrementalSnapshot&&n.data.source===J.MouseMove&&n.data.positions.length?setTimeout(()=>{r()},Math.max(0,50-n.data.positions[0].timeOffset)):r()}this.emitter.emit(m.EventCast,n)}},(null==t||!t.liveMode)&&e.length<2)throw new Error("Replayer need at least 2 events.");var r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:In,useVirtualDom:!0};this.config=Object.assign({},r,t),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(m.Resize,this.handleResize),this.setupDom();for(const i of this.config.plugins||[])i.getMirror&&i.getMirror({nodeMirror:this.mirror});this.emitter.on(m.Flush,()=>{if(this.usingVirtualDom){var e={mirror:this.mirror,applyCanvas:(e,t,r)=>{hn({event:e,mutation:t,target:r,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(e,t)=>{e.source===J.StyleSheetRule?this.applyStyleSheetRule(e,t):e.source===J.StyleDeclaration&&this.applyStyleDeclaration(e,t)}};if(this.iframe.contentDocument&&I(this.iframe.contentDocument,this.virtualDom,e,this.virtualDom.mirror),this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const n in this.legacy_missingNodeRetryMap)try{var t=this.legacy_missingNodeRetryMap[n],r=yr(t.node,this.mirror,this.virtualDom.mirror);I(r,t.node,e,this.virtualDom.mirror),t.node=r}catch(e){this.config.showWarning&&console.warn(e)}this.constructedStyleMutations.forEach(e=>{this.applyStyleSheetMutation(e)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(e=>{this.applyAdoptedStyleSheet(e)}),this.adoptedStyleSheets=[]}this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(m.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});r=new Ar([],{speed:this.config.speed,liveMode:this.config.liveMode});this.service=nn({events:e.map(e=>t&&t.unpackFn?t.unpackFn(e):e).sort((e,t)=>e.timestamp-t.timestamp),timer:r,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(e=>{this.emitter.emit(m.StateChange,{player:e})}),this.speedService=Xr(Hr({id:"speed",context:{normalSpeed:-1,timer:r},initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(e,t)=>{"payload"in t&&e.timer.setSpeed(t.payload.speed)},recordSpeed:Ur({normalSpeed:e=>e.timer.speed}),restoreSpeed:e=>{e.timer.setSpeed(e.normalSpeed)}}})),this.speedService.start(),this.speedService.subscribe(e=>{this.emitter.emit(m.StateChange,{speed:e})});const n=this.service.state.context.events.find(e=>e.type===K.Meta),o=this.service.state.context.events.find(e=>e.type===K.FullSnapshot);if(n){const{width:s,height:a}=n.data;setTimeout(()=>{this.emitter.emit(m.Resize,{width:s,height:a})},0)}o&&setTimeout(()=>{var e;this.firstFullSnapshot||(this.firstFullSnapshot=o,this.rebuildFullSnapshot(o),null==(e=this.iframe.contentWindow))||e.scrollTo(o.data.initialOffset)},1),this.service.state.context.events.find(Tn)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(e,t){return this.emitter.on(e,t),this}off(e,t){return this.emitter.off(e,t),this}setConfig(t){Object.keys(t).forEach(e=>{t[e],this.config[e]=t[e]}),this.config.skipInactive||this.backToNormal(),typeof t.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:t.speed}}),typeof t.mouseTail<"u"&&(!1===t.mouseTail?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){var e=this.service.state.context.events[0],t=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:t.timestamp,totalTime:t.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){var{baselineTime:e,events:t}=this.service.state.context;return e-t[0].timestamp}getMirror(){return this.mirror}play(e=0){this.service.state.matches("paused")||this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}}),null!=(e=null==(e=this.iframe.contentDocument)?void 0:e.getElementsByTagName("html")[0])&&e.classList.remove("rrweb-paused"),this.emitter.emit(m.Start)}pause(e){void 0===e&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),"number"==typeof e&&(this.play(e),this.service.send({type:"PAUSE"})),null!=(e=null==(e=this.iframe.contentDocument)?void 0:e.getElementsByTagName("html")[0])&&e.classList.add("rrweb-paused"),this.emitter.emit(m.Pause)}resume(e=0){console.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(m.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(m.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){const t=this.config.unpackFn?this.config.unpackFn(e):e;Tn(t)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:t}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=me()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),!1!==this.config.mouseTail&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");var e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(Lr(this.iframe.contentWindow,this.iframe.contentDocument),Te(this.iframe.contentWindow))}rebuildFullSnapshot(e,t=!1){if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&console.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const n=[],r=(e,t)=>{this.collectIframeAndAttachDocument(n,e);for(const r of this.config.plugins||[])r.onBuild&&r.onBuild(e,{id:t,replayer:this})};ve(e.data.node,{doc:this.iframe.contentDocument,afterAppend:r,cache:this.cache,mirror:this.mirror}),r(this.iframe.contentDocument,e.data.node.id);for(const{mutationInQueue:s,builtNode:a}of n)this.attachDocumentToIframe(s,a),this.newDocumentQueue=this.newDocumentQueue.filter(e=>e!==s);var{documentElement:o,head:i}=this.iframe.contentDocument;this.insertStyleRules(o,i),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(m.FullsnapshotRebuilded,e),t||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,t){var r,n=[`.${this.config.blockClass} { background: currentColor }`,"noscript { display: none !important; }"].concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&n.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){var o=this.virtualDom.createElement("style");this.virtualDom.mirror.add(o,kr(o,this.virtualDom.unserializedId)),e.insertBefore(o,t),o.rules.push({source:J.StyleSheetRule,adds:n.map((e,t)=>({rule:e,index:t}))})}else{var i=document.createElement("style");e.insertBefore(i,t);for(let e=0;e<n.length;e++)null!=(r=i.sheet)&&r.insertRule(n[e],e)}}attachDocumentToIframe(e,i){const s=(this.usingVirtualDom?this.virtualDom:this).mirror,a=[],t=(e,t)=>{this.collectIframeAndAttachDocument(a,e);var r,n=s.getMeta(e);n?.type===j.Element&&"HTML"===n?.tagName.toUpperCase()&&({documentElement:n,head:r}=i.contentDocument,this.insertStyleRules(n,r));for(const o of this.config.plugins||[])o.onBuild&&o.onBuild(e,{id:t,replayer:this})};ye(e.node,{doc:i.contentDocument,mirror:s,hackCss:!0,skipChild:!1,afterAppend:t,cache:this.cache}),t(i.contentDocument,e.node.id);for(const{mutationInQueue:r,builtNode:n}of a)this.attachDocumentToIframe(r,n),this.newDocumentQueue=this.newDocumentQueue.filter(e=>e!==r)}collectIframeAndAttachDocument(e,t){var r;X(t,this.mirror)&&(r=this.newDocumentQueue.find(e=>e.parentId===this.mirror.getId(t)))&&e.push({mutationInQueue:r,builtNode:t})}waitForStylesheetLoad(){var e=null==(e=this.iframe.contentDocument)?void 0:e.head;if(e){const n=new Set;let t,r=this.service.state;const o=()=>{r=this.service.state},i=(this.emitter.on(m.Start,o),this.emitter.on(m.Pause,o),()=>{this.emitter.off(m.Start,o),this.emitter.off(m.Pause,o)});e.querySelectorAll('link[rel="stylesheet"]').forEach(e=>{e.sheet||(n.add(e),e.addEventListener("load",()=>{n.delete(e),0===n.size&&-1!==t&&(r.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(m.LoadStylesheetEnd),t&&clearTimeout(t),i())}))}),0<n.size&&(this.service.send({type:"PAUSE"}),this.emitter.emit(m.LoadStylesheetStart),t=setTimeout(()=>{r.matches("playing")&&this.play(this.getCurrentTime()),t=-1,i()},this.config.loadTimeout))}}preloadAllImages(){return En(this,null,function*(){this.service.state;var e=()=>{this.service.state},t=(this.emitter.on(m.Start,e),this.emitter.on(m.Pause,e),[]);for(const r of this.service.state.context.events)r.type===K.IncrementalSnapshot&&r.data.source===J.CanvasMutation&&(t.push(this.deserializeAndPreloadCanvasEvents(r.data,r)),("commands"in r.data?r.data.commands:[r.data]).forEach(e=>{this.preloadImages(e,r)}));return Promise.all(t)})}preloadImages(e,t){var r;"drawImage"!==e.property||"string"!=typeof e.args[0]||this.imageMap.has(t)||((t=(r=(t=document.createElement("canvas")).getContext("2d"))?.createImageData(t.width,t.height))?.data,JSON.parse(e.args[0]),r?.putImageData(t,0,0))}deserializeAndPreloadCanvasEvents(t,n){return En(this,null,function*(){if(!this.canvasEventMap.has(n)){const r={isUnchanged:!0};var e;"commands"in t?(e=yield Promise.all(t.commands.map(t=>En(this,null,function*(){var e=yield Promise.all(t.args.map(h(this.imageMap,null,r)));return wn(bn({},t),{args:e})}))),!1===r.isUnchanged&&this.canvasEventMap.set(n,wn(bn({},t),{commands:e}))):(e=yield Promise.all(t.args.map(h(this.imageMap,null,r))),!1===r.isUnchanged&&this.canvasEventMap.set(n,wn(bn({},t),{args:e})))}})}applyIncremental(r,n){var e;const o=r["data"];switch(o.source){case J.Mutation:try{this.applyMutation(o,n)}catch(e){this.warn("Exception in mutation "+(e.message||e),o)}break;case J.Drag:case J.TouchMove:case J.MouseMove:n?(a=o.positions[o.positions.length-1],this.mousePos={x:a.x,y:a.y,id:a.id,debugData:o}):(o.positions.forEach(e=>{var t={doAction:()=>{this.moveAndHover(e.x,e.y,e.id,n,o)},delay:e.timeOffset+r.timestamp-this.service.state.context.baselineTime};this.timer.addAction(t)}),this.timer.addAction({doAction(){},delay:r.delay-(null==(a=o.positions[0])?void 0:a.timeOffset)}));break;case J.MouseInteraction:if(-1!==o.id&&!n){var t=new Event(c[o.type].toLowerCase()),i=this.mirror.getNode(o.id);if(!i)return this.debugNodeNotFound(o,o.id);this.emitter.emit(m.MouseInteraction,{type:o.type,target:i});var s=this.config["triggerFocus"];switch(o.type){case c.Blur:"blur"in i&&i.blur();break;case c.Focus:s&&i.focus&&i.focus({preventScroll:!0});break;case c.Click:case c.TouchStart:case c.TouchEnd:n?(o.type===c.TouchStart?this.touchActive=!0:o.type===c.TouchEnd&&(this.touchActive=!1),this.mousePos={x:o.x,y:o.y,id:o.id,debugData:o}):(o.type===c.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(o.x,o.y,o.id,n,o),o.type===c.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):o.type===c.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):o.type===c.TouchEnd&&this.mouse.classList.remove("touch-active"));break;case c.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:i.dispatchEvent(t)}}break;case J.Scroll:if(-1!==o.id)if(this.usingVirtualDom){var a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.scrollData=o}else this.applyScroll(o,n);break;case J.ViewportResize:this.emitter.emit(m.Resize,{width:o.width,height:o.height});break;case J.Input:if(-1!==o.id)if(this.usingVirtualDom){var a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.inputData=o}else this.applyInput(o);break;case J.MediaInteraction:a=(this.usingVirtualDom?this.virtualDom:this).mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);try{o.currentTime&&(a.currentTime=o.currentTime),o.volume&&(a.volume=o.volume),o.muted&&(a.muted=o.muted),o.type===_.Pause&&a.pause(),o.type===_.Play&&a.play(),o.type===_.RateChange&&(a.playbackRate=o.playbackRate)}catch(e){this.config.showWarning&&console.warn("Failed to replay media interactions: "+(e.message||e))}break;case J.StyleSheetRule:case J.StyleDeclaration:this.usingVirtualDom?o.styleId?this.constructedStyleMutations.push(o):!o.id||null!=(a=this.virtualDom.mirror.getNode(o.id))&&a.rules.push(o):this.applyStyleSheetMutation(o);break;case J.CanvasMutation:if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.canvasMutations.push({event:r,mutation:o})}else{a=this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);hn({event:r,mutation:o,target:a,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break;case J.Font:try{var l=new FontFace(o.family,o.buffer?new Uint8Array(JSON.parse(o.fontSource)):o.fontSource,o.descriptors);null!=(e=this.iframe.contentDocument)&&e.fonts.add(l)}catch(e){this.config.showWarning&&console.warn(e)}break;case J.Selection:n?this.lastSelectionData=o:this.applySelection(o);break;case J.AdoptedStyleSheet:this.usingVirtualDom?this.adoptedStyleSheets.push(o):this.applyAdoptedStyleSheet(o)}}applyMutation(h,e){if(this.config.useVirtualDom&&!this.usingVirtualDom&&e&&(this.usingVirtualDom=!0,Dr(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const s in this.legacy_missingNodeRetryMap)try{var t=this.legacy_missingNodeRetryMap[s],r=Mr(t.node,this.virtualDom,this.mirror);r&&(t.node=r)}catch(e){this.config.showWarning&&console.warn(e)}const p=(this.usingVirtualDom?this.virtualDom:this).mirror,u=(h.removes.forEach(t=>{var e,r=p.getNode(t.id);if(!r)return h.removes.find(e=>e.id===t.parentId)?void 0:this.warnNodeNotFound(h,t.id);let n=p.getNode(t.parentId);if(!n)return this.warnNodeNotFound(h,t.parentId);if(t.isShadow&&Z(n)&&(n=n.shadowRoot),p.removeNodeFromMap(r),n)try{n.removeChild(r),this.usingVirtualDom&&"#text"===r.nodeName&&"STYLE"===n.nodeName&&0<(null==(e=n.rules)?void 0:e.length)&&(n.rules=[])}catch(e){if(!(e instanceof DOMException))throw e;this.warn("parent could not remove child in mutation",n,r,h)}}),bn({},this.legacy_missingNodeRetryMap)),m=[],f=e=>{let t=null;return e.nextId&&(t=p.getNode(e.nextId)),null!==e.nextId&&void 0!==e.nextId&&-1!==e.nextId&&!t},n=e=>{if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");let t=p.getNode(e.parentId);if(!t)return(e.node.type===j.Document?this.newDocumentQueue:m).push(e);e.node.isShadow&&(Z(t)||t.attachShadow({mode:"open"}),t=t.shadowRoot);let r=null,n=null;if(e.previousId&&(r=p.getNode(e.previousId)),e.nextId&&(n=p.getNode(e.nextId)),f(e))return m.push(e);if(!e.node.rootId||p.getNode(e.node.rootId)){var o=e.node.rootId?p.getNode(e.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(X(t,p))this.attachDocumentToIframe(e,t);else{var i=(e,t)=>{for(const r of this.config.plugins||[])r.onBuild&&r.onBuild(e,{id:t,replayer:this})},s=ye(e.node,{doc:o,mirror:p,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:i});if(-1===e.previousId||-1===e.nextId)u[e.node.id]={node:s,mutation:e};else{var a=p.getMeta(t);if(a&&a.type===j.Element&&"textarea"===a.tagName&&e.node.type===j.Text)for(const l of Array.isArray(t.childNodes)?t.childNodes:Array.from(t.childNodes))l.nodeType===t.TEXT_NODE&&t.removeChild(l);if(r&&r.nextSibling&&r.nextSibling.parentNode)t.insertBefore(s,r.nextSibling);else if(n&&n.parentNode)t.contains(n)?t.insertBefore(s,n):t.insertBefore(s,null);else{if(t===o)for(;o.firstChild;)o.removeChild(o.firstChild);t.appendChild(s)}if(i(s,e.node.id),this.usingVirtualDom&&"#text"===s.nodeName&&"STYLE"===t.nodeName&&0<(null==(a=t.rules)?void 0:a.length)&&(t.rules=[]),X(s,this.mirror)){const c=this.mirror.getId(s),d=this.newDocumentQueue.find(e=>e.parentId===c);d&&(this.attachDocumentToIframe(d,s),this.newDocumentQueue=this.newDocumentQueue.filter(e=>e!==d))}(e.previousId||e.nextId)&&this.legacy_resolveMissingNode(u,t,s,e)}}}};h.adds.forEach(e=>{n(e)});for(var o=Date.now();m.length;){var i=Me(m);if(m.length=0,500<Date.now()-o){this.warn("Timeout in the loop, please check the resolve tree data:",i);break}for(const a of i)p.getNode(a.value.parentId)?De(a,e=>{n(e)}):this.debug("Drop resolve tree since there is no parent for the root node.",a)}Object.keys(u).length&&Object.assign(this.legacy_missingNodeRetryMap,u),Oe(h.texts).forEach(t=>{var e,r=p.getNode(t.id);if(!r)return h.removes.find(e=>e.id===t.id)?void 0:this.warnNodeNotFound(h,t.id);r.textContent=t.value,this.usingVirtualDom&&0<(null==(e=(r=r.parentNode)?.rules)?void 0:e.length)&&(r.rules=[])}),h.attributes.forEach(t=>{var e=p.getNode(t.id);if(!e)return h.removes.find(e=>e.id===t.id)?void 0:this.warnNodeNotFound(h,t.id);for(const d in t.attributes)if("string"==typeof d){var r=t.attributes[d];if(null===r)e.removeAttribute(d);else if("string"==typeof r)try{if("_cssText"===d&&("LINK"===e.nodeName||"STYLE"===e.nodeName))try{var n=p.getMeta(e),o=(Object.assign(n.attributes,t.attributes),ye(n,{doc:e.ownerDocument,mirror:p,skipChild:!0,hackCss:!0,cache:this.cache})),i=e.nextSibling,s=e.parentNode;if(o&&s){s.removeChild(e),s.insertBefore(o,i),p.replace(t.id,o);break}}catch{}e.setAttribute(d,r)}catch(e){this.config.showWarning&&console.warn("An error occurred may due to the checkout feature.",e)}else if("style"===d){var a,l=r,c=e;for(const u in l)!1===l[u]?c.style.removeProperty(u):l[u]instanceof Array?(a=l[u],c.style.setProperty(u,a[0],a[1])):(a=l[u],c.style.setProperty(u,a))}}})}applyScroll(e,t){var r,n=this.mirror.getNode(e.id);if(!n)return this.debugNodeNotFound(e,e.id);var o=this.mirror.getMeta(n);if(n===this.iframe.contentDocument)null!=(r=this.iframe.contentWindow)&&r.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else if(o?.type===j.Document)null!=(r=n.defaultView)&&r.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else try{n.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"})}catch{}}applyInput(e){var t=this.mirror.getNode(e.id);if(!t)return this.debugNodeNotFound(e,e.id);try{t.checked=e.isChecked,t.value=e.text}catch{}}applySelection(e){try{const i=new Set,t=e.ranges.map(({start:e,startOffset:t,end:r,endOffset:n})=>{var o,e=this.mirror.getNode(e),r=this.mirror.getNode(r);if(e&&r)return(o=new Range).setStart(e,t),o.setEnd(r,n),(t=e.ownerDocument?.getSelection())&&i.add(t),{range:o,selection:t}});i.forEach(e=>e.removeAllRanges()),t.forEach(e=>{var t;return e&&(null==(t=e.selection)?void 0:t.addRange(e.range))})}catch{}}applyStyleSheetMutation(e){var t;let r=null;e.styleId?r=this.styleMirror.getStyle(e.styleId):e.id&&(r=(null==(t=this.mirror.getNode(e.id))?void 0:t.sheet)||null),r&&(e.source===J.StyleSheetRule?this.applyStyleSheetRule(e,r):e.source===J.StyleDeclaration&&this.applyStyleDeclaration(e,r))}applyStyleSheetRule(e,i){var t,r,n;if(null!=(t=e.adds)&&t.forEach(({rule:e,index:t})=>{try{var r,n,o;Array.isArray(t)?({positions:r,index:n}=xe(t),s(i.cssRules,r).insertRule(e,n)):(o=void 0===t?void 0:Math.min(t,i.cssRules.length),i?.insertRule(e,o))}catch{}}),null!=(t=e.removes)&&t.forEach(({index:e})=>{try{var t,r;Array.isArray(e)?({positions:t,index:r}=xe(e),s(i.cssRules,t).deleteRule(r||0)):i?.deleteRule(e)}catch{}}),e.replace)try{null!=(r=i.replace)&&r.call(i,e.replace)}catch{}if(e.replaceSync)try{null!=(n=i.replaceSync)&&n.call(i,e.replaceSync)}catch{}}applyStyleDeclaration(e,t){e.set&&s(t.rules,e.index).style.setProperty(e.set.property,e.set.value,e.set.priority),e.remove&&s(t.rules,e.index).style.removeProperty(e.remove.property)}applyAdoptedStyleSheet(e){var t;const o=this.mirror.getNode(e.id);if(o){null!=(t=e.styles)&&t.forEach(e=>{var t;let r,n=null;if(Z(o)?n=(null==(t=o.ownerDocument)?void 0:t.defaultView)||null:"#document"===o.nodeName&&(n=o.defaultView),n)try{r=new n.CSSStyleSheet,this.styleMirror.add(r,e.styleId),this.applyStyleSheetRule({source:J.StyleSheetRule,adds:e.rules},r)}catch{}});const i=10;let n=0;const s=(e,t)=>{var r=t.map(e=>this.styleMirror.getStyle(e)).filter(e=>null!==e);Z(e)?e.shadowRoot.adoptedStyleSheets=r:"#document"===e.nodeName&&(e.adoptedStyleSheets=r),r.length!==t.length&&n<i&&(setTimeout(()=>s(e,t),0+100*n),n++)};s(o,e.styleIds)}}legacy_resolveMissingNode(e,t,r,n){var o,{previousId:n,nextId:i}=n,n=n&&e[n],i=i&&e[i];n&&({node:n,mutation:o}=n,t.insertBefore(n,r),delete e[o.node.id],delete this.legacy_missingNodeRetryMap[o.node.id],o.previousId||o.nextId)&&this.legacy_resolveMissingNode(e,t,n,o),i&&({node:n,mutation:o}=i,t.insertBefore(n,r.nextSibling),delete e[o.node.id],delete this.legacy_missingNodeRetryMap[o.node.id],o.previousId||o.nextId)&&this.legacy_resolveMissingNode(e,t,n,o)}moveAndHover(e,t,r,n,o){var i=this.mirror.getNode(r);if(!i)return this.debugNodeNotFound(o,r);o=ke(i,this.iframe),r=e*o.absoluteScale+o.x,e=t*o.absoluteScale+o.y;this.mouse.style.left=r+"px",this.mouse.style.top=e+"px",n||this.drawMouseTail({x:r,y:e}),this.hoverElements(i)}drawMouseTail(t){if(this.mouseTail){const{lineCap:e,lineWidth:r,strokeStyle:n,duration:o}=!0===this.config.mouseTail?In:Object.assign({},In,this.config.mouseTail),i=()=>{if(this.mouseTail){const t=this.mouseTail.getContext("2d");t&&this.tailPositions.length&&(t.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),t.beginPath(),t.lineWidth=r,t.lineCap=e,t.strokeStyle=n,t.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(e=>t.lineTo(e.x,e.y)),t.stroke())}};this.tailPositions.push(t),i(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(e=>e!==t),i()},o/this.speedService.state.context.timer.speed)}}hoverElements(e){var t;null!=(t=this.iframe.contentDocument)&&t.querySelectorAll(".\\:hover").forEach(e=>{e.classList.remove(":hover")});let r=e;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(e){return e.type===K.IncrementalSnapshot&&e.data.source>J.Mutation&&e.data.source<=J.Input}backToNormal(){this.nextUserInteractionEvent=null,this.speedService.state.matches("normal")||(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(m.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,t){this.warn(`Node with id '${t}' not found. `,e)}warnCanvasMutationFailed(e,t){this.warn("Has error on canvas update",t,"canvas mutation:",e)}debugNodeNotFound(e,t){this.debug(Cn,`Node with id '${t}' not found. `,e)}warn(...e){this.config.showWarning&&console.warn(Cn,...e)}debug(...e){this.config.showDebug&&console.log(Cn,...e)}},e.ReplayerEvents=m,e.addCustomEvent=l,e.freezePage=Mn,e.record=o,e.utils=r,Object.defineProperty(e,"__esModule",{value:!0}),e}({});function TrackerSession(t){let r={url:"http://localhost:3000"},n=[],e=t?.seconds||30;if(t.apiKey)return{start:function(){o(),rrweb.record({emit(e){n.push(e)}})}};throw new Error("You forgot informed apiKey on options.");function o(){setInterval(async()=>{var e;e=n,await!fetch(r.url+"/events",{method:"POST",headers:{"api-key":t.apiKey,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({useAgent:window.navigator.userAgent,route:location.pathname,events:e})}),n=[]},1e3*e)}}